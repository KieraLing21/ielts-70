<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SÆ¡ Ä‘á»“ CÃ¢y Lá»™ trÃ¬nh IELTS 7.0 (12 ThÃ¡ng)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/index.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>HÃ nh TrÃ¬nh Chinh Phá»¥c 7.0</h1>
            <p style="color: var(--text-muted);">Há»c song song MIS & BABOK | ChuyÃªn sÃ¢u Listening & Speaking</p>
        </header>

        <section class="stats-grid">
            <div class="stat-item">
                <div class="lbl">Tá»•ng tiáº¿n Ä‘á»™</div>
                <div class="val" id="overall-val">0%</div>
            </div>
            <div class="stat-item">
                <div class="lbl">Giai Ä‘oáº¡n hiá»‡n táº¡i</div>
                <div class="val" id="current-phase-name" style="font-size: 1.2rem;">Phase 1</div>
            </div>
            <div class="stat-item">
                <div class="lbl">Tá»•ng sá»‘ phiÃªn há»c</div>
                <div class="val" id="total-sessions-global">0</div>
            </div>
        </section>

        <main class="tree-container" id="tree-root"></main>
    </div>

    <script>
        window.lastActiveEditorId = 'vocab-editor';
        document.addEventListener('focusin', (e) => {
            if (e.target.classList && e.target.classList.contains('sentence-editor')) {
                window.lastActiveEditorId = e.target.id;
            }
        });

        const stages = [
            {
                id: 1,
                name: "Block 1: Foundation (0 - 5.0)",
                startWeek: 1,
                endWeek: 12,
                tasks: ["PhÃ¡t Ã¢m IPA/Shadowing", "Listening (VOA/BBC)", "Speaking (Khung CÃ¢u)", "Tá»« vá»±ng Core/MIS"]
            },
            {
                id: 2,
                name: "Block 2: Academy (5.0 - 6.5)",
                startWeek: 13,
                endWeek: 24,
                tasks: ["IELTS Listening S1-2", "Speaking Part 1 & 2 Intro", "Reading & Writing CÆ¡ Báº£n", "Academic & BA Vocab"]
            },
            {
                id: 3,
                name: "Block 3: Precision (6.5 - 7.0+)",
                startWeek: 25,
                endWeek: 36,
                tasks: ["IELTS Listening S3-4", "Speaking Part 2 & 3 ChuyÃªn SÃ¢u", "Writing Task 1 & 2", "Mock Test & Mock Interview (BA)"]
            }
        ];

        // Persistence State
        let userData = JSON.parse(localStorage.getItem('ielts_tree_data')) || {};

        function save() {
            localStorage.setItem('ielts_tree_data', JSON.stringify(userData));
            updateOverallProgress();
        }

        const phase1Routine = `
        <div style="margin-top:16px; padding:16px; background:rgba(197,160,0,0.03); border-radius:12px; border:1px solid rgba(139,115,85,0.1)">
            <div style="font-size:0.9rem; font-weight:800; color:var(--primary); margin-bottom:12px; text-transform:uppercase; letter-spacing:1px; display:flex; align-items:center; gap:8px">
                <span>ğŸ“‹ Routine HÃ ng NgÃ y (KhÃ´ng Ä‘Æ°á»£c bá»)</span>
            </div>
            <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:15px">
                <div style="background:white; padding:10px; border-radius:8px; box-shadow:0 2px 4px rgba(0,0,0,0.02)">
                    <div style="font-weight:700; color:var(--primary); margin-bottom:4px">ğŸ—£ï¸ PhÃ¡t Ã¢m (30')</div>
                    <div style="font-size:0.75rem; color:var(--text-muted)">IPA, Ná»‘i/Nuá»‘t Ã¢m, Shadowing cÃ¢u ngáº¯n.</div>
                </div>
                <div style="background:white; padding:10px; border-radius:8px; box-shadow:0 2px 4px rgba(0,0,0,0.02)">
                    <div style="font-weight:700; color:var(--primary); margin-bottom:4px">ğŸ§ Listening (40')</div>
                    <div style="font-size:0.75rem; color:var(--text-muted)">Nghe hiá»ƒu Ã½ trÆ°á»›c -> Check script sau.</div>
                </div>
                <div style="background:white; padding:10px; border-radius:8px; box-shadow:0 2px 4px rgba(0,0,0,0.02)">
                    <div style="font-weight:700; color:var(--primary); margin-bottom:4px">ğŸ™ï¸ Speaking (30')</div>
                    <div style="font-size:0.75rem; color:var(--text-muted)">NÃ³i theo khung 4-Tier. 1 chá»§ Ä‘á»/ngÃ y.</div>
                </div>
                <div style="background:white; padding:10px; border-radius:8px; box-shadow:0 2px 4px rgba(0,0,0,0.02)">
                    <div style="font-weight:700; color:var(--primary); margin-bottom:4px">ğŸ“š Vocab (30')</div>
                    <div style="font-size:0.75rem; color:var(--text-muted)">15' Core + 15' MIS. CÃ¢u Ä‘Æ¡n + BA context.</div>
                </div>
            </div>
        </div>`;

        const weeklyGoals = {
            "p1-w1": "Reset ná»n táº£ng: Thuá»™c 20-25 Ã¢m IPA, Nghe hiá»ƒu ~40% ná»™i dung cháº­m, NÃ³i Ä‘Æ°á»£c 1 phÃºt khÃ´ng Ä‘á»©ng hÃ¬nh." + phase1Routine,
            "p1-w2": "Luyá»‡n nháº¡y bÃ©n: PhÃ¢n biá»‡t Ä‘Æ°á»£c cÃ¡c Ã¢m gáº§n giá»‘ng, Nghe Ä‘Æ°á»£c cá»¥m tá»«, NÃ³i Ä‘Æ°á»£c 1-1.5 phÃºt." + phase1Routine,
            "p1-w3": "Pháº£n xáº¡ Shadowing: Báº¯t Ä‘áº§u Shadowing, Nghe hiá»ƒu Ã½ chÃ­nh IELTS Section 1, NÃ³i Ä‘Æ°á»£c 2 phÃºt chá»§ Ä‘á» quen." + phase1Routine,
            "p1-w4": "Cá»§ng cá»‘ & Má»Ÿ rá»™ng: PhÃ¡t Ã¢m rÃµ rÃ ng, CÃ³ 600-800 tá»« vá»±c active, KhÃ´ng cÃ²n sá»£ nghe tiáº¿ng Anh." + phase1Routine,
            "p2": "Luyá»‡n táº­p Pre-IELTS: LÃ m quen format Cam 1-9, Speaking Part 1 trÃ´i cháº£y, Báº¯t Ä‘áº§u tÆ° duy Academic.",
            "p3": "TÄƒng tá»‘c 6.5+: Listening Section 3-4, Speaking Part 2-3 káº¿t há»£p chuyÃªn ngÃ nh MIS/BABOK.",
            "p4": "Vá» Ä‘Ã­ch 7.0: Giáº£i Ä‘á» Cam 10-18, PhÃ¢n tÃ­ch lá»—i sai cá»±c ká»¹ (Deep Analysis), Mock test á»•n Ä‘á»‹nh 7.0."
        };

        const weekDetails = {
            "p1-w1": {
                7: true,
                days: {
                    1: ["PhÃ¡t Ã¢m: /iË/ vs /Éª/ (Short/Long i)", "Listening: VOA - Intro D.C.", "Speaking: Greeting & Major (4-Tier)", "Vocab: Intro to MIS Roles", "Grammar: Verb To Be (am/is/are)"],
                    2: ["PhÃ¡t Ã¢m: /ÊŒ/ vs /É‘Ë/ (Cup/Car)", "Listening: BBC - Job market", "Speaking: Morning Routine (4-Tier)", "Vocab: Business Analysis Basics", "Grammar: Verb Have & Do"],
                    3: ["PhÃ¡t Ã¢m: /e/ vs /Ã¦/ (Bed/Bad)", "Listening: VOA - Education news", "Speaking: Study Habits (4-Tier)", "Vocab: System Analyst Duties", "Grammar: Be + Adjective"],
                    4: ["PhÃ¡t Ã¢m: /É’/ vs /É”Ë/ (Hot/Sport)", "Listening: BBC - Free time", "Speaking: Hobbies & Stakeholders", "Vocab: Stakeholder Groups", "Grammar: Have + Noun & Do + Activity"],
                    5: ["PhÃ¡t Ã¢m: /Î¸/ vs /Ã°/ (Thin/This)", "Listening: VOA - Digital World", "Speaking: Learning Motivation (4-Tier)", "Vocab: Requirement Gathering Intro", "Grammar: Want to / Need to / Have to"],
                    6: ["PhÃ¡t Ã¢m: /ÊŠ/ vs /uË/ (Book/Boot)", "Listening: BBC - Travel Tips", "Speaking: Past Trips & Analytics", "Vocab: Data & Infrastructure Basics", "Grammar: Can / Can't"],
                    7: ["Weekly Review: IPA Vowels Master", "Listening: Deep Dictation Challenge", "Speaking: Mock Speaking Part 1", "Vocab: Weekly 150-Word Audit", "Grammar: Review Be / Have / Do / Can"]
                }
            },
            "p1-w2": {
                days: {
                    1: ["PhÃ¡t Ã¢m: /eÉª/ & /aÉª/ (Diphthongs)", "Listening: VOA - My Family", "Speaking: Family & Hierarchy (4-Tier)", "Vocab: Family & Org Structure", "Grammar: Simple Present - S+V(s/es)"],
                    2: ["PhÃ¡t Ã¢m: /É”Éª/ & /É™ÊŠ/ (Boy/Go)", "Listening: BBC - Smart Homes", "Speaking: House & Tech Hardware", "Vocab: Household & HW Inventory", "Grammar: There is / There are"],
                    3: ["PhÃ¡t Ã¢m: /aÊŠ/ & /ÉªÉ™/ (How/Ear)", "Listening: VOA - Daily Life", "Speaking: Housework & Responsibilities", "Vocab: Roles & Accountabilities", "Grammar: Frequency Adverbs (always/usually)"],
                    4: ["PhÃ¡t Ã¢m: /eÉ™/ & /ÊŠÉ™/ (Hair/Sure)", "Listening: BBC - Generations", "Speaking: Childhood & Line Managers", "Vocab: Management Levels", "Grammar: Wh- Questions (Where/What/Who)"],
                    5: ["PhÃ¡t Ã¢m: Review 8 Diphthongs", "Listening: VOA - Modern Society", "Speaking: Family Values & MIS Teams", "Vocab: MIS Team Collaboration", "Grammar: Negative (don't / doesn't)"],
                    6: ["Ã”n táº­p: Diphthongs & Family/MIS", "Listening: Weekly Review Challenge", "Speaking: Mock Speaking Part 1", "Vocab: Weekly 150-Word Audit", "Grammar: Review Simple Present (+)(-)(?)"]
                }
            },
            "p1-w3": {
                days: {
                    1: ["PhÃ¡t Ã¢m: Ná»‘i Ã¢m nÃ¢ng cao (linking sounds)", "Listening: IELTS Section 1 (Easy) - Nghe Ã½ chÃ­nh", "Speaking: Describe a person - 2'", "Vocab: 10 tá»« IELTS + 5 tá»« MIS (Analysis)"],
                    2: ["PhÃ¡t Ã¢m: Giáº£m Ã¢m (reduction)", "Listening: VOA Level 2 (Science/Tech) - Shadowing", "Speaking: Describe a place - 2'", "Vocab: 10 tá»« IELTS + 5 tá»« MIS (Design)"],
                    3: ["PhÃ¡t Ã¢m: Nuá»‘t Ã¢m (elision)", "Listening: BBC 6 Min - Ghi chÃº chi tiáº¿t", "Speaking: Describe an object - 2'", "Vocab: 10 tá»« IELTS + 5 tá»« MIS (Development)"],
                    4: ["PhÃ¡t Ã¢m: Luyá»‡n táº­p Shadowing (15')", "Listening: IELTS Section 1 (Medium) - Nghe chi tiáº¿t", "Speaking: Describe an event - 2'", "Vocab: 10 tá»« IELTS + 5 tá»« MIS (Testing)"],
                    5: ["PhÃ¡t Ã¢m: Tá»‘c Ä‘á»™ nÃ³i tá»± nhiÃªn (natural pace)", "Listening: VOA Level 2 - Deep Listening", "Speaking: Talk about your hometown - 2'", "Vocab: 10 tá»« IELTS + 5 tá»« MIS (Deployment)"],
                    6: ["Ã”n táº­p: PhÃ¡t Ã¢m & Ngá»¯ Ä‘iá»‡u tuáº§n 3", "Listening: Review IELTS Section 1", "Speaking: Mock Speaking Part 1 (3 topic má»›i)", "Vocab: Ã”n táº­p tá»« vá»±ng active tuáº§n 3"]
                }
            },
            "p1-w4": {
                days: {
                    1: ["PhÃ¡t Ã¢m: Luyá»‡n táº­p 44 Ã¢m IPA (15')", "Listening: IELTS Section 2 (Easy) - Nghe Ã½ chÃ­nh", "Speaking: Talk about your favorite book/movie - 2'", "Vocab: 10 tá»« IELTS + 5 tá»« MIS (Maintenance)"],
                    2: ["PhÃ¡t Ã¢m: Luyá»‡n táº­p ná»‘i Ã¢m, giáº£m Ã¢m, nuá»‘t Ã¢m", "Listening: VOA Level 3 (Economy/Politics) - Shadowing", "Speaking: Talk about a memorable trip - 2'", "Vocab: 10 tá»« IELTS + 5 tá»« MIS (Support)"],
                    3: ["PhÃ¡t Ã¢m: Luyá»‡n táº­p ngá»¯ Ä‘iá»‡u cÃ¢u há»i/cÃ¢u tráº§n thuáº­t", "Listening: BBC 6 Min - TÃ³m táº¯t ná»™i dung", "Speaking: Talk about your future plans - 2'", "Vocab: 10 tá»« IELTS + 5 tá»« MIS (Upgrade)"],
                    4: ["PhÃ¡t Ã¢m: Luyá»‡n táº­p tá»‘c Ä‘á»™ nÃ³i tá»± nhiÃªn (20')", "Listening: IELTS Section 2 (Medium) - Nghe chi tiáº¿t", "Speaking: Talk about a skill you want to learn - 2'", "Vocab: 10 tá»« IELTS + 5 tá»« MIS (Innovation)"],
                    5: ["PhÃ¡t Ã¢m: Tá»•ng Ã´n phÃ¡t Ã¢m toÃ n diá»‡n", "Listening: VOA Level 3 - Deep Listening", "Speaking: Talk about a challenge you faced - 2'", "Vocab: 10 tá»« IELTS + 5 tá»« MIS (Strategy)"],
                    6: ["Ã”n táº­p: Kiá»ƒm tra phÃ¡t Ã¢m & Ä‘á»™ trÃ´i cháº£y", "Listening: Review IELTS Section 2", "Speaking: Mock Speaking Part 1 (3 topic khÃ³)", "Vocab: Tá»•ng Ã´n 600-800 tá»« vá»±ng active"]
                }
            }
        };

        // Helper Functions
        function getTaskIcon(taskName, idx) {
            const lower = taskName.toLowerCase();
            if (lower.includes('phÃ¡t Ã¢m') || idx === 0) return 'ğŸ—£ï¸';
            if (lower.includes('listening') || idx === 1) return 'ğŸ§';
            if (lower.includes('speaking') || idx === 2) return 'ğŸ™ï¸';
            if (lower.includes('vocab') || idx === 3) return 'ğŸ“š';
            if (lower.includes('grammar') || idx === 4) return 'ğŸ“';
            return 'ğŸ“';
        }

        function isDayDone(dayId) {
            if (!userData[dayId]) return false;
            const details = userData[dayId].details || [];
            if (details.length === 0) return false;
            return details.every(d => d.done);
        }

        function getTaskStatus(dayId, taskIdx) {
            if (!userData[dayId] || !userData[dayId].details || !userData[dayId].details[taskIdx]) {
                return '';
            }
            return userData[dayId].details[taskIdx].done ? 'done' : '';
        }



        function renderDiscoveries(dayId) {
            const discoveries = userData[dayId]?.discoveries || [];
            if (discoveries.length === 0) return '';

            return `
                <div class="discovery-zone">
                    <div style="font-size:0.7rem; text-transform:uppercase; color:var(--primary); font-weight:800; margin-bottom:10px; display:flex; align-items:center; gap:5px; opacity:0.8">
                        <span>ğŸ’ Personal Discovery</span>
                    </div>
                    ${discoveries.map((item, idx) => `
                        <div class="discovery-item" onclick="if('${item.url}') window.open('${item.url}', '_blank')">
                            <div class="discovery-content">
                                <span class="discovery-type">${item.type}</span>
                                <span class="discovery-title">${item.title}</span>
                                <div class="discovery-note">${item.note}</div>
                            </div>
                            <button class="btn-delete-gem" onclick="event.stopPropagation(); deleteDiscovery('${dayId}', ${idx})">Ã—</button>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        window.openDiscoveryForm = (dayId) => {
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 450px;">
                    <span class="close-x" onclick="closeModal()">Ã—</span>
                    <div class="modal-header">
                        <h2 style="font-size:1.5rem">âœ¨ Add New Gem</h2>
                        <p>ThÃªm bÃ i há»c hay báº¡n vá»«a khÃ¡m phÃ¡ Ä‘Æ°á»£c</p>
                    </div>
                    <div class="form-group">
                        <label>Loáº¡i kiáº¿n thá»©c</label>
                        <select id="discovery-type" style="width:100%; background:var(--bg-dark); border:1px solid var(--glass-border); padding:10px; border-radius:8px; color:var(--text-main)">
                            <option value="ğŸ§ Listening">BÃ i nghe / Podcast</option>
                            <option value="ğŸ“– Reading">BÃ i bÃ¡o / Blog</option>
                            <option value="ğŸ“š Vocab">Cá»¥m tá»« / Idiom hay</option>
                            <option value="ğŸ’¡ Advice">Lá»i khuyÃªn / Tips</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>TiÃªu Ä‘á» / TÃªn bÃ i</label>
                        <input id="discovery-title" type="text" placeholder="VÃ­ dá»¥: BBC Learning English - Global Warming" style="width:100%; background:var(--bg-dark); border:1px solid var(--glass-border); padding:10px; border-radius:8px; color:var(--text-main)">
                    </div>
                    <div class="form-group">
                        <label>Link (náº¿u cÃ³)</label>
                        <input id="discovery-url" type="text" placeholder="https://..." style="width:100%; background:var(--bg-dark); border:1px solid var(--glass-border); padding:10px; border-radius:8px; color:var(--text-main)">
                    </div>
                    <div class="form-group">
                        <label>Ghi chÃº nhanh / Key Takeaway</label>
                        <textarea id="discovery-note" placeholder="Báº¡n há»c Ä‘Æ°á»£c gÃ¬ tá»« bÃ i nÃ y?" style="min-height:80px;"></textarea>
                    </div>
                    <div class="modal-actions">
                        <button class="btn btn-close" onclick="closeModal()">Há»§y</button>
                        <button class="btn btn-primary" onclick="saveDiscovery('${dayId}')">LÆ°u vÃ o Lab</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        };

        window.saveDiscovery = (dayId) => {
            const type = document.getElementById('discovery-type').value;
            const title = document.getElementById('discovery-title').value.trim();
            const url = document.getElementById('discovery-url').value.trim();
            const note = document.getElementById('discovery-note').value.trim();

            if (!title) {
                alert("Vui lÃ²ng nháº­p tiÃªu Ä‘á»!");
                return;
            }

            if (!userData[dayId]) userData[dayId] = {};
            if (!userData[dayId].discoveries) userData[dayId].discoveries = [];

            userData[dayId].discoveries.push({ type, title, url, note });
            save();
            renderTree();
            closeModal();
        };

        window.deleteDiscovery = (dayId, idx) => {
            if (!confirm("XÃ³a kiáº¿n thá»©c nÃ y khá»i Lab?")) return;
            userData[dayId].discoveries.splice(idx, 1);
            save();
            renderTree();
        };

        function renderTree() {
            const root = document.getElementById('tree-root');
            root.innerHTML = '';

            stages.forEach(stage => {
                const phaseNode = document.createElement('div');
                phaseNode.className = 'phase-node';

                const phaseHeader = document.createElement('div');
                phaseHeader.className = 'phase-header';
                phaseHeader.innerHTML = `<span>${stage.name}</span> <span class="chevron">â–¼</span>`;
                phaseHeader.onclick = () => {
                    const container = phaseNode.querySelector('.blocks-container');
                    container.classList.toggle('hidden');
                    phaseHeader.classList.toggle('open');
                };
                phaseNode.appendChild(phaseHeader);

                const blocksContainer = document.createElement('div');
                blocksContainer.className = 'blocks-container hidden';

                for (let w = stage.startWeek; w <= stage.endWeek; w++) {
                    const blockNode = document.createElement('div');
                    blockNode.className = 'block-node';

                    // Use p1 prefix for all weeks to remain compatible with data structure, 
                    // or mapping to stage.id if preferred. We'll use p1 for consistency with new-day workflow
                    const blockId = `p1-w${w}`;
                    let rawGoal = weeklyGoals[blockId] || weeklyGoals[`p${stage.id}`] || "Tiáº¿p tá»¥c bÃ¡m sÃ¡t lá»™ trÃ¬nh giai Ä‘oáº¡n.";

                    // Split Goal Text and Routine HTML
                    let goalText = rawGoal;
                    let goalRoutine = "";
                    if (rawGoal.includes('<div')) {
                        const parts = rawGoal.split('<div');
                        goalText = parts[0];
                        goalRoutine = '<div' + parts.slice(1).join('<div');
                    }

                    const blockHeader = document.createElement('div');
                    blockHeader.className = 'block-header';
                    blockHeader.style.display = 'grid';
                    blockHeader.style.gridTemplateColumns = '250px 1fr';
                    blockHeader.style.gap = '20px';
                    blockHeader.style.alignItems = 'center';

                    blockHeader.innerHTML = `
                        <div class="week-info-col">
                            <div style="display:flex; align-items:center; gap:10px; margin-bottom:5px">
                                <div class="week-badge">Week ${w}</div>
                                <span style="font-weight:700; color:var(--text-main)">Cháº·ng ${w}</span>
                            </div>
                            <span class="progress-pills">${renderPills(blockId)}</span>
                        </div>
                        <div class="week-goal-col" style="border-left:2px solid rgba(139,115,85,0.1); padding-left:20px">
                             <div style="font-size:0.8rem; text-transform:uppercase; color:var(--primary); font-weight:800; margin-bottom:2px">ğŸ¯ Má»¥c tiÃªu focus</div>
                             <div style="font-size:0.9rem; color:var(--text-main); line-height:1.4">${goalText}</div>
                        </div>
                    `;

                    blockHeader.onclick = (e) => {
                        const days = blockNode.querySelector('.days-container');
                        days.classList.toggle('hidden');
                        // Optional: Animate or toggle icon
                    };
                    blockNode.appendChild(blockHeader);

                    const daysContainer = document.createElement('div');
                    daysContainer.className = 'days-container hidden';

                    // Routine Display (Inside Expanded)
                    if (goalRoutine) {
                        const routineDiv = document.createElement('div');
                        routineDiv.innerHTML = goalRoutine;
                        // Routine styling overrides to fit inside card
                        daysContainer.appendChild(routineDiv);
                    }

                    const currentWeekInfo = weekDetails[blockId];
                    const daysInWeek = (currentWeekInfo && currentWeekInfo[7]) ? 7 : 6;

                    for (let d = 1; d <= daysInWeek; d++) {
                        const dayId = `${blockId}-d${d}`;
                        const dayCard = document.createElement('div');
                        dayCard.className = 'day-card';

                        let displayTasks = stage.tasks;
                        if (currentWeekInfo && currentWeekInfo.days && currentWeekInfo.days[d]) {
                            displayTasks = currentWeekInfo.days[d];
                        }

                        const isDone = isDayDone(dayId);
                        const dayCurriculum = lessonCurriculum[dayId];
                        let summaryHtml = '';

                        if (dayCurriculum && dayCurriculum.summary) {
                            summaryHtml = `
                                <div class="day-summary" style="flex:1 1 250px; background:rgba(197,160,0,0.03); border-left:3px solid var(--primary); padding:12px; border-radius:8px; font-size:0.8rem; height:fit-content; border:1px solid rgba(197,160,0,0.1); border-left-width:4px">
                                    <div style="margin-bottom:4px"><strong>ğŸ“‚ Topic:</strong> ${dayCurriculum.summary.topic || ''}</div>
                                    ${dayCurriculum.summary.grammar ? `<div style="margin-bottom:4px; color: #5a3e1b; background: rgba(197,160,0,0.1); padding:4px 8px; border-radius:6px"><strong>ğŸ“ Grammar:</strong> ${dayCurriculum.summary.grammar}</div>` : ''}
                                    <div style="margin-bottom:4px"><strong>ğŸ™ï¸ Ph.Ã‚m:</strong> ${dayCurriculum.summary.pronunciation || ''}</div>
                                    <div style="margin-bottom:4px"><strong>ğŸ§ List:</strong> ${dayCurriculum.summary.listening || ''}</div>
                                    <div style="margin-bottom:4px"><strong>ğŸ—£ï¸ Speak:</strong> ${dayCurriculum.summary.speaking || ''}</div>
                                    <div><strong>ğŸ“š Vocab:</strong> ${dayCurriculum.summary.vocab || ''}</div>
                                </div>
                            `;
                        }

                        dayCard.innerHTML = `
                             <div class="day-header ${isDone ? 'finished' : ''}">
                                <div class="day-title">Day ${d}</div>
                                ${isDone ? '<div class="day-badge">HoÃ n thÃ nh</div>' : ''}
                            </div>
                            ${summaryHtml}
                            <div class="day-tasks">
                                ${displayTasks.map((t, idx) => `
                                    <div class="task-row ${getTaskStatus(dayId, idx)}" onclick="openTaskForm('${dayId}', ${idx}, '${t.replace(/'/g, "\\'")}')">
                                        <div class="task-icon">${getTaskIcon(t, idx)}</div>
                                        <div class="task-info">
                                            <span class="task-text">${t}</span>
                                        </div>
                                        <div class="task-status-dot"></div>
                                    </div>
                                `).join('')}
                            </div>
                            <div class="discovery-section" style="flex: 0 0 200px; border-left: 1px solid rgba(139, 115, 85, 0.1); padding-left: 20px; display: flex; flex-direction: column; justify-content: space-between;">
                                ${renderDiscoveries(dayId)}
                                <button class="btn-discovery" onclick="openDiscoveryForm('${dayId}')">
                                    <span>âœ¨</span> Add Discovery
                                </button>
                            </div>
                        `;
                        daysContainer.appendChild(dayCard);
                    }
                    blockNode.appendChild(daysContainer);
                    blocksContainer.appendChild(blockNode);
                }

                phaseNode.appendChild(blocksContainer);
                root.appendChild(phaseNode);
            });
        }

        const lessonCurriculum = {
            "p1-w1-d1": {
                summary: {
                    topic: "Personal Info (IELTS) | Intro to MIS Roles (MIS)",
                    grammar: "Verb To Be (am/is/are) - Giá»›i thiá»‡u báº£n thÃ¢n",
                    pronunciation: "/i:/ vs /Éª/ | Connected: Wake up, Check it out",
                    listening: "VOA Level 1: \"Welcome to Washington D.C.\"",
                    speaking: "Greetings & Major (Dual-Context)",
                    vocab: "25 words (10 Core, 10 MIS, 5 Listening)"
                },
                0: {
                    type: "pronunciation",
                    title: "PhÃ¡t Ã¢m /i:/ vs /Éª/ (MIS Fundamentals)",
                    dailyWords: [
                        { w: "See", p: "/siË/", m: "To be conscious of what is around you by using your eyes.", s: "Turn the light on so I can see." },
                        { w: "Sit", p: "/sÉªt/", m: "To rest your body on a seat.", s: "Many people get back pain from sitting at a desk for too long." },
                        { w: "Feel", p: "/fiËl/", m: "To experience something physical or emotional.", s: "How would you feel about moving to a different city?" },
                        { w: "Fit", p: "/fÉªt/", m: "To be the right size or shape for someone or something.", s: "These shoes fit me well." },
                        { w: "Meet", p: "/miËt/", m: "To come together with someone.", s: "Let's meet at 3 PM." },
                        { w: "Miss", p: "/mÉªs/", m: "To fail to do or experience something.", s: "I missed the last train." },
                        { w: "Sleep", p: "/sliËp/", m: "To rest with your eyes closed and your mind and body not active.", s: "I need to sleep early tonight." },
                        { w: "Slip", p: "/slÉªp/", m: "To slide by accident or to make a small mistake.", s: "Don't slip on the wet floor." },
                        { w: "Eat", p: "/iËt/", m: "To put food into your mouth and swallow it.", s: "I eat breakfast at 7 AM." },
                        { w: "Bit", p: "/bÉªt/", m: "A small amount or piece of something.", s: "I'm a bit tired today." }
                    ],
                    specializedWords: [
                        { w: "Team", p: "/tiËm/", m: "A group of people with a common goal.", s: "Our team is very strong." },
                        { w: "System", p: "/ËˆsÉªs.tÉ™m/", m: "A set of connected things that work together.", s: "a central heating system" },
                        { w: "Achieve", p: "/É™ËˆtÊƒiËv/", m: "To succeed in finishing something or reaching a goal.", s: "I want to achieve my goals." },
                        { w: "Business", p: "/ËˆbÉªznÉ™s/", m: "The activity of buying and selling goods and services.", s: "Business is good this quarter." },
                        { w: "Feasible", p: "/ËˆfiËzÉ™bl/", m: "Able to be made, done, or achieved.", s: "Is this plan feasible?" },
                        { w: "Risk", p: "/rÉªsk/", m: "The possibility of something bad happening.", s: "There is some risk involved." },
                        { w: "Feature", p: "/ËˆfiËtÊƒÉ™/", m: "A typical quality or an important part of something.", s: "This phone has many features." },
                        { w: "Deliver", p: "/dÉªËˆlÉªvÉ™/", m: "To take something to a particular person or place.", s: "Can you deliver this package?" },
                        { w: "Agree", p: "/É™ËˆÉ¡riË/", m: "To have the same opinion.", s: "I agree with you." },
                        { w: "Limit", p: "/ËˆlÉªmÉªt/", m: "The greatest amount or number that is possible or allowed.", s: "There is a speed limit here." }
                    ],
                    connectedSpeech: [
                        { text: "Wake up", linking: "/weÉª kÊŒp/", type: "Ná»‘i Ã¢m", note: "Phá»¥ Ã¢m /k/ ná»‘i vá»›i nguyÃªn Ã¢m /ÊŒ/." },
                        { text: "Check it out", linking: "/tÊƒekÉªtaÊŠt/", type: "Ná»‘i Ã¢m", note: "Ná»‘i liÃªn hoÃ n: /k/ sang /Éª/ vÃ  /t/ sang /aÊŠ/." },
                        { text: "Good day", linking: "/É¡ÊŠdeÉª/", type: "Nuá»‘t Ã¢m", note: "Hai phá»¥ Ã¢m /d/ Ä‘á»©ng cáº¡nh nhau, nuá»‘t bá»›t 1 Ã¢m." },
                        { text: "Last night", linking: "/lÉ‘Ës naÉªt/", type: "Nuá»‘t Ã¢m", note: "Ã‚m /t/ á»Ÿ giá»¯a hai phá»¥ Ã¢m thÆ°á»ng bá»‹ nuá»‘t." },
                        { text: "City of data", linking: "/ËˆsÉªti jÉ™v ËˆdeÉªtÉ™/", type: "Ná»‘i Ã¢m", note: "Ã‚m /i/ ná»‘i vá»›i /É™/ thÃªm Ã¢m lÆ°á»›t /j/." }
                    ],
                    steps: [
                        { num: 1, text: "Xem Video: 'Pronunciation of EE [i] and IH [Éª]'", link: "https://www.youtube.com/watch?v=kYJj0vE916w" },
                        { num: 2, text: "Luyá»‡n kháº©u hÃ¬nh: LÆ°á»¡i cao, mÃ´i dáº¹p cho /i:/ vÃ  tháº£ lá»ng cho /Éª/." }
                    ]
                },
                1: {
                    type: "listening",
                    title: "VOA Level 1",
                    steps: [
                        { num: 1, text: "BÃ i há»c chÃ­nh: VOA Lesson 2 - \"Hello, I'm Anna!\" (Welcome to Washington DC)", link: "https://learningenglish.voanews.com/a/lets-learn-english-lesson-2-hello/3113733.html" },
                        { num: 2, text: "Dá»± phÃ²ng (YouTube):", link: "https://www.youtube.com/watch?v=3W0L47Nn2iI" },
                        { num: 3, text: "Nghe khÃ´ng script báº¯t keyword." },
                        { num: 4, text: "Nghe cÃ³ script check ná»‘i Ã¢m." },
                        { num: 5, text: "Ghi Ã¢m láº¡i Ä‘oáº¡n quan trá»ng nháº¥t." }
                    ]
                },
                2: {
                    type: "speaking", title: "Intro & Major (Dual-Context)",
                    scenarios: [
                        {
                            title: "ğŸŒ± Daily Context: Greeting & Name",
                            questions: ["How should I call you?", "Where are you from?"],
                            samples: `**Direct:** You can call me [Name], and I'm originally from Hanoi.
**Reason:** I prefer this name because it's short and easy for everyone to remember.
**Example:** For instance, my colleagues at the office always use this name during our casual chats.
**Therefore:** It creates a friendly atmosphere and helps me connect with people easily.`
                        },
                        {
                            title: "ğŸ“ Professional Context: MIS & BABOK",
                            questions: ["What is your current major?", "Why did you choose it?"],
                            samples: `**Direct:** I'm currently specializing in Management Information Systems (MIS).
**Reason:** I have a deep interest in how information technology can be leveraged to solve complex business problems.
**Example:** For example, I'm fascinated by the "Elicitation" process in BABOK, which helps in gathering accurate requirements.
**Therefore:** My goal is to bridge the gap between technical teams and business stakeholders effectively.`
                        }
                    ]
                },
                3: {
                    type: "vocabulary", title: "MIS Core Concepts (15' Core + 15' MIS + 10' Listening)",
                    core: [
                        { w: "See", p: "/siË/", m: "To be conscious of what is around you by using your eyes.", s: "Turn the light on so I can see.", a: "The analyst could see (that) the project was struggling to meet its goals." },
                        { w: "Sit", p: "/sÉªt/", m: "To rest your body on a seat.", s: "Many people get back pain from sitting at a desk for too long.", a: "The committee will sit next week to review the proposal." },
                        { w: "Feel", p: "/fiËl/", m: "To experience something physical or emotional.", s: "How would you feel about moving to a different city?", a: "Stakeholders feel confident about the new system implementation." },
                        { w: "Fit", p: "/fÉªt/", m: "To be the right size or shape for someone or something.", s: "These shoes fit me well.", a: "The solution must fit within the existing infrastructure constraints." },
                        { w: "Meet", p: "/miËt/", m: "To come together with someone.", s: "Let's meet at 3 PM.", a: "The project must meet all regulatory compliance requirements." },
                        { w: "Miss", p: "/mÉªs/", m: "To fail to do or experience something.", s: "I missed the last train.", a: "We cannot afford to miss critical deadlines in this sprint." },
                        { w: "Sleep", p: "/sliËp/", m: "To rest with your eyes closed and your mind and body not active.", s: "I need to sleep early tonight.", a: "The server will sleep mode during off-peak hours to save energy." },
                        { w: "Slip", p: "/slÉªp/", m: "To slide by accident or to make a small mistake.", s: "Don't slip on the wet floor.", a: "A small slip in data entry can cause significant reporting errors." },
                        { w: "Eat", p: "/iËt/", m: "To put food into your mouth and swallow it.", s: "I eat breakfast at 7 AM.", a: "The new feature will eat up considerable system resources." },
                        { w: "Bit", p: "/bit/", m: "A small amount or piece of something.", s: "I'm a bit tired today.", a: "Each bit of information contributes to the overall data integrity." }
                    ],
                    specialized: [
                        { w: "Team", p: "/tiËm/", m: "A group of people with a common goal.", s: "Our team is very strong.", a: "The cross-functional team collaborates on requirements elicitation." },
                        { w: "System", p: "/ËˆsÉªs.tÉ™m/", m: "A set of connected things that work together.", s: "a central heating system", a: "The system keeps crashing and no one is able to figure out why." },
                        { w: "Achieve", p: "/É™ËˆtÊƒiËv/", s: "I want to achieve my goals.", a: "We aim to achieve operational excellence through process optimization." },
                        { w: "Business", p: "/ËˆbÉªznÉ™s/", s: "Business is good this quarter.", a: "Business analysis identifies gaps between current and desired states." },
                        { w: "Feasible", p: "/ËˆfiËzÉ™bl/", s: "Is this plan feasible?", a: "The technical feasibility study confirms the solution is viable." },
                        { w: "Risk", p: "/rÉªsk/", s: "There is some risk involved.", a: "Risk assessment is crucial for project planning and mitigation strategies." },
                        { w: "Feature", p: "/ËˆfiËtÊƒÉ™/", s: "This phone has many features.", a: "Each feature must be mapped to specific business requirements." },
                        { w: "Deliver", p: "/dÉªËˆlÉªvÉ™/", s: "Can you deliver this package?", a: "We deliver value incrementally through agile sprints." },
                        { w: "Agree", p: "/É™ËˆÉ¡riË/", s: "I agree with you.", a: "All stakeholders must agree on the acceptance criteria before development." },
                        { w: "Limit", p: "/ËˆlÉªmÉªt/", s: "There is a speed limit here.", a: "System limits must be defined to prevent resource exhaustion." }
                    ],
                    fromListening: [
                        { w: "Capital", p: "/ËˆkÃ¦pÉªtl/", context: "Washington D.C. is the capital of the United States." },
                        { w: "Museum", p: "/mjuËËˆziËÉ™m/", context: "The museum has many historical artifacts." },
                        { w: "Monument", p: "/ËˆmÉ’njÊŠmÉ™nt/", context: "The Washington Monument is very tall." },
                        { w: "Tourist", p: "/ËˆtÊŠÉ™rÉªst/", context: "Many tourists visit the city every year." },
                        { w: "Visit", p: "/ËˆvÉªzÉªt/", context: "I want to visit Washington D.C. someday." }
                    ]
                },
                4: {
                    type: "grammar",
                    title: "Grammar Focus: Verb To Be (am/is/are)",
                    theory: "'To Be' lÃ  Ä‘á»™ng tá»« cá»‹ nháº¥t trong tiáº¿ng Anh. DÃ¹ng Ä‘á»ƒ giá»›i thiá»‡u báº£n thÃ¢n, mÃ´ táº£ ngÆ°á»i/váº­t, vÃ  xÃ¡c nháº­n danh tÃ­nh.",
                    formula: "I am | He/She/It is | We/You/They are",
                    examples: [
                        { context: "ğŸŒ± Daily", sentence: "I **am** a student of MIS at university.", note: "DÃ¹ng 'am' vá»›i chá»§ ngá»¯ 'I'." },
                        { context: "ğŸ“ MIS", sentence: "The system **is** currently undergoing maintenance.", note: "DÃ¹ng 'is' vá»›i chá»§ ngá»¯ sá»‘ Ã­t (He/She/It)." }
                    ],
                    exercise: "Viáº¿t 3 cÃ¢u giá»›i thiá»‡u báº£n thÃ¢n vÃ  cÃ´ng viá»‡c cá»§a báº¡n báº±ng To Be."
                }
            },
            "p1-w1-d2": {
                summary: {
                    topic: "Personal Items (IELTS) | Business Analysis Intro (MIS)",
                    grammar: "Verb To Have & Do - ThÃ³i quen & CÃ´ng viá»‡c hÃ ng ngÃ y",
                    pronunciation: "/ÊŒ/ vs /É‘Ë/ | Connected: Come on, Start again",
                    listening: "BBC: Job Market Trends",
                    speaking: "Morning Routine (4-Tier Framework)",
                    vocab: "25 words (Task, Solution, Market, Budget...)"
                },
                0: {
                    type: "pronunciation",
                    title: "PhÃ¡t Ã¢m /ÊŒ/ vs /É‘Ë/ (Cup/Car)",
                    dailyWords: [
                        { w: "Love", p: "/lÊŒv/" }, { w: "Car", p: "/kÉ‘Ë/" }, { w: "Cup", p: "/kÊŒp/" },
                        { w: "Start", p: "/stÉ‘Ët/" }, { w: "Run", p: "/rÊŒn/" }, { w: "Park", p: "/pÉ‘Ëk/" },
                        { w: "Luck", p: "/lÊŒk/" }, { w: "Hard", p: "/hÉ‘Ëd/" }, { w: "Sun", p: "/sÊŒn/" }, { w: "Art", p: "/É‘Ët/" }
                    ],
                    specializedWords: [
                        { w: "Structure", p: "/ËˆstrÊŒktÊƒÉ™/" }, { w: "Target", p: "/ËˆtÉ‘ËÉ¡Éªt/" }, { w: "Budget", p: "/ËˆbÊŒdÊ’Éªt/" },
                        { w: "Market", p: "/ËˆmÉ‘ËkÉªt/" }, { w: "Function", p: "/ËˆfÊŒÅ‹kÊƒn/" }, { w: "Partner", p: "/ËˆpÉ‘ËtnÉ™/" },
                        { w: "Conduct", p: "/ËˆkÉ’ndÊŒkt/" }, { w: "Chart", p: "/tÊƒÉ‘Ët/" }, { w: "Result", p: "/rÉªËˆzÊŒlt/" }, { w: "Department", p: "/dÉªËˆpÉ‘ËtmÉ™nt/" }
                    ],
                    connectedSpeech: [
                        { text: "Bus station", linking: "/ËˆbÊŒsteÉªÊƒn/", type: "Nuá»‘t Ã¢m", note: "Hai Ã¢m /s/ Ä‘i liá»n nhau nuá»‘t bá»›t 1 Ã¢m." },
                        { text: "Come on", linking: "/kÊŒm É’n/", type: "Ná»‘i Ã¢m", note: "Phá»¥ Ã¢m /m/ ná»‘i vá»›i nguyÃªn Ã¢m /É’/." },
                        { text: "Just now", linking: "/dÊ’ÊŒs naÊŠ/", type: "Nuá»‘t Ã¢m", note: "Ã‚m /t/ bá»‹ nuá»‘t giá»¯a hai phá»¥ Ã¢m." },
                        { text: "Love it", linking: "/lÊŒvÉªt/", type: "Ná»‘i Ã¢m", note: "Phá»¥ Ã¢m /v/ ná»‘i vá»›i nguyÃªn Ã¢m /Éª/." },
                        { text: "Start again", linking: "/stÉ‘Ët É™ËˆÉ¡en/", type: "Ná»‘i Ã¢m", note: "Phá»¥ Ã¢m /t/ ná»‘i vá»›i nguyÃªn Ã¢m /É™/." }
                    ],
                    steps: [
                        { num: 1, text: "Xem Video: 'Cup vs Car - /ÊŒ/ and /É‘:/'", link: "https://www.youtube.com/watch?v=0kIovgBivK0" },
                        { num: 2, text: "Luyá»‡n Connected Speech: 'Love it' vÃ  'Start again'." }
                    ]
                },
                1: {
                    type: "listening",
                    title: "BBC: Future of Work",
                    steps: [
                        { num: 1, text: "What is the future of work? (BBC):", link: "https://www.bbc.co.uk/learningenglish/features/6-minute-english_2024/ep-240201" },
                        { num: 2, text: "Dá»± phÃ²ng (YouTube):", link: "https://www.youtube.com/watch?v=s1HxJVusR2w" },
                        { num: 3, text: "Note 5 cá»¥m tá»« liÃªn quan Ä‘áº¿n Business/Work." }
                    ]
                },
                2: {
                    type: "speaking", title: "Daily & Work Routine (4-Tier Focus)",
                    scenarios: [
                        {
                            title: "ğŸŒ± Daily Context: Morning Routine",
                            questions: ["What is your morning routine?", "How do you start your day?"],
                            samples: `**Opinion:** I usually kick off my day at 6 AM.
**Reason:** Starting early gives me a head start on my daily tasks.
**Example:** For instance, I spend the first 30 minutes reading news or studying IPA.
**Therefore:** This disciplined routine helps me stay focused and energetic for work.`
                        },
                        {
                            title: "ğŸ“ Professional Context: Business Analysis Basics",
                            questions: ["What does a Business Analyst do?", "Why is it important for a company?"],
                            samples: `**Opinion:** A BA essentially acts as a bridge between business needs and IT solutions.
**Reason:** Without this role, technical teams might build features that don't solve the actual problem.
**Example:** For example, a BA conducts stakeholder interviews to define the exact project scope.
**Therefore:** It ensures that the final system meets all business requirements and delivers value.`
                        }
                    ]
                },
                3: {
                    type: "vocabulary", title: "Work & BA Intro (25 words)",
                    core: [
                        { w: "Task", p: "/tÉ‘Ësk/", s: "Assign a task.", a: "Task analysis is a key BA technique." },
                        { w: "Work", p: "/wÉœËk/", s: "I work hard.", a: "The Work Breakdown Structure (WBS) defines project scope." },
                        { w: "Job", p: "/dÊ’É’b/", s: "New job offer.", a: "Job shadowing helps in understanding user workflows." },
                        { w: "Busy", p: "/ËˆbÉªzi/", s: "A busy day.", a: "Busy stakeholders need concise reports." },
                        { w: "Hard", p: "/hÉ‘Ëd/", s: "A hard exam.", a: "Hard skills like SQL are vital for MIS." },
                        { w: "Plan", p: "/plÃ¦n/", s: "Daily plan.", a: "The project plan includes risk mitigation." },
                        { w: "Goal", p: "/É¡É™ÊŠl/", s: "Personal goal.", a: "Business goals drive system requirements." },
                        { w: "Time", p: "/taÉªm/", s: "Dinner time.", a: "Time-to-market is a critical business metric." },
                        { w: "Start", p: "/stÉ‘Ët/", s: "Start now.", a: "Kick-off meetings start the project lifecycle." },
                        { w: "Done", p: "/dÊŒn/", s: "Well done!", a: "Definition of Done (DoD) is crucial in Agile." }
                    ],
                    specialized: [
                        { w: "Business", p: "/ËˆbÉªznÉ™s/", s: "Local business.", a: "Business requirements describe high-level goals." },
                        { w: "Solution", p: "/sÉ™ËˆluËÊƒn/", s: "Find a solution.", a: "The proposed solution must be technically feasible." },
                        { w: "Analysis", p: "/É™ËˆnÃ¦lÉ™sÉªs/", s: "Data analysis.", a: "Gap analysis identifies what is missing in the system." },
                        { w: "Market", p: "/ËˆmÉ‘ËkÉªt/", s: "Market price.", a: "Market research informs product development." },
                        { w: "Budget", p: "/ËˆbÊŒdÊ’Éªt/", s: "Tight budget.", a: "The project budget limits the available resources." },
                        { w: "Result", p: "/rÉªËˆzÊŒlt/", s: "Exam result.", a: "Positive results validate the BA intervention." },
                        { w: "Target", p: "/ËˆtÉ‘ËÉ¡Éªt/", s: "Target audience.", a: "Target architecture defines the future system state." },
                        { w: "Process", p: "/ËˆprÉ™ÊŠses/", s: "Long process.", a: "Business process modeling improves efficiency." },
                        { w: "Partner", p: "/ËˆpÉ‘ËtnÉ™/", s: "Travel partner.", a: "Strategic partners collaborate on integration." },
                        { w: "Function", p: "/ËˆfÊŒÅ‹kÊƒn/", s: "Basic function.", a: "Functional specs define system behavior." }
                    ],
                    fromListening: [
                        { w: "Career", p: "/kÉ™ËˆrÉªÉ™/", context: "A successful career in IT." },
                        { w: "Salary", p: "/ËˆsÃ¦lÉ™ri/", context: "A competitive annual salary." },
                        { w: "Skill", p: "/skÉªl/", context: "Soft skills are essential for BAs." },
                        { w: "Interview", p: "/ËˆÉªntÉ™vjuË/", context: "The initial stakeholder interview." },
                        { w: "Experience", p: "/ÉªkËˆspÉªÉ™riÉ™ns/", context: "Prior experience in data modeling." }
                    ]
                },
                4: {
                    type: "grammar",
                    title: "Grammar Focus: Verb Have & Do",
                    theory: "'Have' diá»…n táº£ sá»Ÿ há»¯u hoáº·c tráº£i nghiá»‡m. 'Do' dÃ¹ng Ä‘á»ƒ há»i vÃ  cháº·n Ä‘á»‹nh thÃ¬ hiá»‡n táº¡i Ä‘Æ¡n (auxiliary), hoáº·c diá»…n táº£ hÃ nh Ä‘á»™ng thÃ´ng thÆ°á»ng.",
                    formula: "I have / I do | He has / He does (+s/es)",
                    examples: [
                        { context: "ğŸŒ± Daily", sentence: "I **have** a morning routine that starts at 6 AM.", note: "'Have' = sá»Ÿ há»¯u, táº¡o thÃ³i quen." },
                        { context: "ğŸ“ MIS", sentence: "She **does** a weekly status report for the team.", note: "'Does' = thá»±c hiá»‡n má»™t hÃ nh Ä‘á»™ng Ä‘á»‹nh ká»³." }
                    ],
                    exercise: "Viáº¿t 2 cÃ¢u vá» thÃ³i quen báº¡n cÃ³ vÃ o buá»•i sÃ¡ng. DÃ¹ng 'have' vÃ  'do'."
                }
            },
            "p1-w1-d3": {
                summary: {
                    topic: "Education (IELTS) | System Analyst Duties (MIS)",
                    grammar: "Be + Adjective & Do + Verb - MÃ´ táº£ tÃ­nh cháº¥t",
                    pronunciation: "/e/ vs /Ã¦/ | Connected: Get out, Send it",
                    listening: "VOA: Education in the AI Era",
                    speaking: "Study Habits (4-Tier Framework)",
                    vocab: "25 words (Analyst, Model, Diagram, Scope...)"
                },
                0: {
                    type: "pronunciation",
                    title: "PhÃ¡t Ã¢m /e/ vs /Ã¦/ (Bed/Bad)",
                    dailyWords: [
                        { w: "Bed", p: "/bed/" }, { w: "Bad", p: "/bÃ¦d/" }, { w: "Men", p: "/men/" },
                        { w: "Man", p: "/mÃ¦n/" }, { w: "Send", p: "/send/" }, { w: "Sand", p: "/sÃ¦nd/" },
                        { w: "Check", p: "/tÊƒek/" }, { w: "Back", p: "/bÃ¦k/" }, { w: "Head", p: "/hed/" }, { w: "Hand", p: "/hÃ¦nd/" }
                    ],
                    specializedWords: [
                        { w: "Network", p: "/ËˆnetwÉœËk/" }, { w: "Access", p: "/ËˆÃ¦kses/" }, { w: "Method", p: "/ËˆmeÎ¸É™d/" },
                        { w: "Asset", p: "/ËˆÃ¦set/" }, { w: "Metric", p: "/ËˆmetrÉªk/" }, { w: "Agile", p: "/ËˆÃ¦dÊ’aÉªl/" },
                        { w: "Test", p: "/test/" }, { w: "Plan", p: "/plÃ¦n/" }, { w: "Level", p: "/Ëˆlevl/" }, { w: "Map", p: "/mÃ¦p/" }
                    ],
                    connectedSpeech: [
                        { text: "Get out", linking: "/É¡et aÊŠt/", type: "Ná»‘i Ã¢m", note: "Phá»¥ Ã¢m /t/ ná»‘i vá»›i nguyÃªn Ã¢m /aÊŠ/." },
                        { text: "Bad day", linking: "/bÃ¦ deÉª/", type: "Nuá»‘t Ã¢m", note: "Ã‚m /d/ thá»© nháº¥t bá»‹ nuá»‘t." },
                        { text: "Send it", linking: "/sendÉªt/", type: "Ná»‘i Ã¢m", note: "Ná»‘i /d/ vá»›i /Éª/." },
                        { text: "Check up", linking: "/tÊƒek ÊŒp/", type: "Ná»‘i Ã¢m", note: "Ná»‘i /k/ vá»›i /ÊŒ/." },
                        { text: "Map out", linking: "/mÃ¦paÊŠt/", type: "Ná»‘i Ã¢m", note: "Ná»‘i /p/ vá»›i /aÊŠ/." }
                    ],
                    steps: [
                        { num: 1, text: "Xem Video: 'Bed vs Bad - /e/ and /Ã¦/'", link: "https://www.youtube.com/watch?v=q66f363J6U4" },
                        { num: 2, text: "Luyá»‡n Connected Speech: 'Send it' vÃ  'Map out'." }
                    ]
                },
                1: {
                    type: "listening",
                    title: "VOA: Education Systems",
                    steps: [
                        { num: 1, text: "Nghe vá» há»‡ thá»‘ng giÃ¡o dá»¥c hiá»‡n Ä‘áº¡i (VOA):", link: "https://learningenglish.voanews.com/a/lets-learn-english-lesson-50-back-to-school/3807270.html" },
                        { num: 2, text: "Dá»± phÃ²ng (YouTube):", link: "https://www.youtube.com/watch?v=27-mOQ43Q3I" },
                        { num: 3, text: "Highlight cÃ¡c tá»« vá»±ng vá» Degrees & Training." }
                    ]
                },
                2: {
                    type: "speaking", title: "Study & MIS Duties (4-Tier Focus)",
                    scenarios: [
                        {
                            title: "ğŸŒ± Daily Context: Study Habits",
                            questions: ["How do you prepare for exams?", "Do you prefer group study?"],
                            samples: `**Opinion:** I usually stick to a structured study schedule.
**Reason:** It ensures I cover all modules without feeling overwhelmed.
**Example:** For instance, I allocate specific hours for IPA drills and IELTS vocabulary.
**Therefore:** This consistency is the key to mastering a new language.`
                        },
                        {
                            title: "ğŸ“ Professional Context: System Analyst Duties",
                            questions: ["What is the role of a System Analyst?", "What tools do they use?"],
                            samples: `**Opinion:** A System Analyst focuses on designing the technical blueprint for software.
**Reason:** They ensure that the hardware and software components work in harmony.
**Example:** For example, they create Sequence Diagrams to model system interactions.
**Therefore:** A good analyst prevents technical debt and ensures system scalability.`
                        }
                    ]
                },
                3: {
                    type: "vocabulary", title: "Education & System Docs (25 words)",
                    core: [
                        { w: "Learn", p: "/lÉœËn/", s: "Learn English.", a: "We learn from past project failures." },
                        { w: "Book", p: "/bÊŠk/", s: "Read books.", a: "Book a slot for a stakeholder workshop." },
                        { w: "Grade", p: "/É¡reÉªd/", s: "A+ grade.", a: "The system grade determines the security level." },
                        { w: "Exam", p: "/ÉªÉ¡ËˆzÃ¦m/", s: "Final exam.", a: "The QA team must examine the code for bugs." },
                        { w: "School", p: "/skuËl/", s: "High school.", a: "The technical school of thought differs here." },
                        { w: "Teach", p: "/tiËtÊƒ/", s: "Teach me.", a: "Internal training helps teach the new workflow." },
                        { w: "Class", p: "/klÉ‘Ës/", s: "Math class.", a: "The main class in Java handles the logic." },
                        { w: "Note", p: "/nÉ™ÊŠt/", s: "Take notes.", a: "Release notes explain the new system updates." },
                        { w: "Hand", p: "/hÃ¦nd/", s: "Hold my hand.", a: "Hand over the project documentation." },
                        { w: "Head", p: "/hed/", s: "Head office.", a: "The head of IT approves the budget." }
                    ],
                    specialized: [
                        { w: "Analyst", p: "/ËˆÃ¦nÉ™lÉªst/", s: "SA role.", a: "The analyst bridges the gap between teams." },
                        { w: "Diagram", p: "/ËˆdaÉªÉ™É¡rÃ¦m/", s: "Flow diagram.", a: "UML diagrams visualize system architecture." },
                        { w: "Model", p: "/ËˆmÉ’dl/", s: "3D model.", a: "Data modeling defines the database schema." },
                        { w: "Scope", p: "/skÉ™ÊŠp/", s: "Project scope.", a: "Scope creep leads to project delays." },
                        { w: "Logic", p: "/ËˆlÉ’dÊ’Éªk/", s: "Clear logic.", a: "The business logic is the core of the app." },
                        { w: "Method", p: "/ËˆmeÎ¸É™d/", s: "New method.", a: "Agile methodology is preferred in MIS." },
                        { w: "Network", p: "/ËˆnetwÉœËk/", s: "Social network.", a: "A secure network infrastructure is essential." },
                        { w: "Asset", p: "/ËˆÃ¦set/", s: "Valuable asset.", a: "Digital assets must be protected from risks." },
                        { w: "Metric", p: "/ËˆmetrÉªk/", s: "Key metric.", a: "System performance metrics track latency." },
                        { w: "Map", p: "/mÃ¦p/", s: "City map.", a: "Process mapping helps identify bottlenecks." }
                    ],
                    fromListening: [
                        { w: "Campus", p: "/ËˆkÃ¦mpÉ™s/", context: "The university campus environment." },
                        { w: "Degree", p: "/dÉªËˆÉ¡riË/", context: "A master's degree in MIS." },
                        { w: "Lectured", p: "/ËˆlektÊƒÉ™d/", context: "The professor lectured on database design." },
                        { w: "Online", p: "/ËˆÉ’nlaÉªn/", context: "Remote online learning platforms." },
                        { w: "Training", p: "/ËˆtreÉªnÉªÅ‹/", context: "Professional training for new hires." }
                    ]
                },
                4: {
                    type: "grammar",
                    title: "Grammar Focus: Be + Adjective",
                    theory: "Káº¿t há»£p 'To Be' vá»›i má»™t tÃ­nh tá»« (Adjective) Ä‘á»ƒ mÃ´ táº£ Ä‘áº·c Ä‘iá»ƒm cá»§a ngÆ°á»i, sá»± viá»‡c hoáº·c há»‡ thá»‘ng. Cáº¥u trÃºc nÃ y ráº¥t phá»• biáº¿n trong IELTS Speaking Part 1.",
                    formula: "S + am/is/are + Adjective",
                    examples: [
                        { context: "ğŸŒ± Daily", sentence: "The lecture **is** very interesting and practical.", note: "MÃ´ táº£ bÃ i giáº£ng báº±ng tÃ­nh tá»«." },
                        { context: "ğŸ“ MIS", sentence: "The new system **is** highly scalable and cost-effective.", note: "MÃ´ táº£ Ä‘áº·c tÃ­nh ká»¹ thuáº­t cá»§a há»‡ thá»‘ng." }
                    ],
                    exercise: "Viáº¿t 2 cÃ¢u mÃ´ táº£ cáº©u trÃºc há»c táº­p cá»§a báº¡n vÃ  má»™t há»‡ thá»‘ng IT báº¡n Ä‘Ã£ dÃ¹ng."
                }
            },
            "p1-w1-d4": {
                summary: {
                    topic: "Hobbies (IELTS) | Stakeholder Management (MIS)",
                    grammar: "Have + Noun / Do + Activity - Sá»Ÿ thÃ­ch & Hoáº¡t Ä‘á»™ng",
                    pronunciation: "/É’/ vs /É”Ë/ | Connected: Talk about, Log in",
                    listening: "BBC: The Science of Relaxation",
                    speaking: "Free Time & Stakeholders (4-Tier Framework)",
                    vocab: "25 words (Owner, Sponsor, Vendor, Actor...)"
                },
                0: {
                    type: "pronunciation",
                    title: "PhÃ¡t Ã¢m /É’/ vs /É”Ë/ (Hot/Sport)",
                    dailyWords: [
                        { w: "Hot", p: "/hÉ’t/" }, { w: "Sport", p: "/spÉ”Ët/" }, { w: "Box", p: "/bÉ’ks/" },
                        { w: "Talk", p: "/tÉ”Ëk/" }, { w: "Stop", p: "/stÉ’p/" }, { w: "Walk", p: "/wÉ”Ëk/" },
                        { w: "Job", p: "/dÊ’É’b/" }, { w: "Short", p: "/ÊƒÉ”Ët/" }, { w: "Cost", p: "/kÉ’st/" }, { w: "Call", p: "/kÉ”Ël/" }
                    ],
                    specializedWords: [
                        { w: "Process", p: "/ËˆprÉ™ÊŠses/" }, { w: "Audit", p: "/ËˆÉ”ËdÉªt/" }, { w: "Cost", p: "/kÉ’st/" },
                        { w: "Report", p: "/rÉªËˆpÉ”Ët/" }, { w: "Log", p: "/lÉ’É¡/" }, { w: "Talk", p: "/tÉ”Ëk/" },
                        { w: "Block", p: "/blÉ’k/" }, { w: "Score", p: "/skÉ”Ë/" }, { w: "Model", p: "/ËˆmÉ’dl/" }, { w: "Core", p: "/kÉ”Ë/" }
                    ],
                    connectedSpeech: [
                        { text: "Talk about", linking: "/tÉ”Ëk É™ËˆbaÊŠt/", type: "Ná»‘i Ã¢m", note: "Ná»‘i /k/ vá»›i /É™/." },
                        { text: "Hot tea", linking: "/hÉ’tiË/", type: "Nuá»‘t Ã¢m", note: "Ná»‘i /t/ vá»›i /t/ thÃ nh 1 Ã¢m." },
                        { text: "Stop it", linking: "/stÉ’pÉªt/", type: "Ná»‘i Ã¢m", note: "Ná»‘i /p/ vá»›i /Éª/." },
                        { text: "Walk away", linking: "/wÉ”Ëk É™ËˆweÉª/", type: "Ná»‘i Ã¢m", note: "Ná»‘i /k/ vá»›i /É™/." },
                        { text: "Log in", linking: "/lÉ’É¡Éªn/", type: "Ná»‘i Ã¢m", note: "Ná»‘i /g/ vá»›i /Éª/." }
                    ],
                    steps: [
                        { num: 1, text: "Xem Video: 'Pronunciation of /É’/ vs /É”Ë/'", link: "https://www.youtube.com/watch?v=R3XfSg5jUj4" },
                        { num: 2, text: "Luyá»‡n Connected Speech: 'Talk about' vÃ  'Log in'." }
                    ]
                },
                1: {
                    type: "listening",
                    title: "BBC: Relaxation & Hobbies",
                    steps: [
                        { num: 1, text: "The benefits of doing nothing (BBC):", link: "https://www.bbc.co.uk/learningenglish/features/6-minute-english_2023/ep-230615" },
                        { num: 2, text: "Dá»± phÃ²ng (YouTube):", link: "https://www.youtube.com/watch?v=fXvV7B5L7vI" },
                        { num: 3, text: "Note cÃ¡c tá»« vá»±ng chá»‰ Leisure activities." }
                    ]
                },
                2: {
                    type: "speaking", title: "Hobbies & Stakeholders (4-Tier Focus)",
                    scenarios: [
                        {
                            title: "ğŸŒ± Daily Context: Favorite Hobbies",
                            questions: ["What do you enjoy doing?", "How often do you do it?"],
                            samples: `**Opinion:** I'm genuinely passionate about playing football.
**Reason:** It is a fantastic way to release stress after a demanding workday.
**Example:** On average, I hit the pitch with my local team twice a week.
**Therefore:** It keeps me physically fit and mentally balanced.`
                        },
                        {
                            title: "ğŸ“ Professional Context: Managing Stakeholders",
                            questions: ["Who is a stakeholder?", "How do you handle them?"],
                            samples: `**Opinion:** A stakeholder is anyone with an interest in the project results.
**Reason:** Their support or opposition can make or break the project.
**Example:** For instance, the Project Sponsor provides the funding, while vendors provide the tech.
**Therefore:** A BA must engage them early to align their expectations.`
                        }
                    ]
                },
                3: {
                    type: "vocabulary", title: "Leisure & Stakeholders (25 words)",
                    core: [
                        { w: "Play", p: "/pleÉª/", s: "Play football.", a: "Stakeholders play a key role in signing off." },
                        { w: "Fun", p: "/fÊŒn/", s: "Have fun.", a: "Interactive UIs add a sense of fun to apps." },
                        { w: "Like", p: "/laÉªk/", s: "I like sports.", a: "The system behaves like a legacy one." },
                        { w: "Read", p: "/riËd/", s: "Read news.", a: "Read-only access is for basic users." },
                        { w: "Cook", p: "/kÊŠk/", s: "I cook daily.", a: "Bad data entry can cook the books." },
                        { w: "Talk", p: "/tÉ”Ëk/", s: "Talk to me.", a: "Daily talk helps in team bonding." },
                        { w: "Stop", p: "/stÉ’p/", s: "Stop there.", a: "A stop-gap solution is only temporary." },
                        { w: "Call", p: "/kÉ”Ël/", s: "Call him.", a: "Call the API to fetch data." },
                        { w: "Walk", p: "/wÉ”Ëk/", s: "Walk fast.", a: "A walk-through session reviews code." },
                        { w: "Box", p: "/bÉ’ks/", s: "Empty box.", a: "Out-of-the-box features are ready to use." }
                    ],
                    specialized: [
                        { w: "Stakeholder", p: "/ËˆsteÉªkhÉ™ÊŠldÉ™/", s: "Key stakeholder.", a: "Identify all stakeholders at the start." },
                        { w: "Sponsor", p: "/ËˆspÉ’nsÉ™/", s: "Project sponsor.", a: "The sponsor provides the project budget." },
                        { w: "Owner", p: "/ËˆÉ™ÊŠnÉ™/", s: "Process owner.", a: "The product owner manages the backlog." },
                        { w: "Vendor", p: "/ËˆvendÉ™/", s: "Tech vendor.", a: "Vendor selection is based on SLAs." },
                        { w: "Actor", p: "/ËˆÃ¦ktÉ™/", s: "Lead actor.", a: "In Use Cases, an actor triggers an action." },
                        { w: "Audit", p: "/ËˆÉ”ËdÉªt/", s: "Annual audit.", a: "The system audit trail tracks every change." },
                        { w: "Report", p: "/rÉªËˆpÉ”Ët/", s: "Weekly report.", a: "A status report keeps sponsors informed." },
                        { w: "Group", p: "/É¡ruËp/", s: "Small group.", a: "User groups have different system permissions." },
                        { w: "Expert", p: "/ËˆekspÉœËt/", s: "Ask an expert.", a: "SMEs provide domain expertise during elicitation." },
                        { w: "Client", p: "/ËˆklaÉªÉ™nt/", s: "Ideal client.", a: "Meeting client needs is our top priority." }
                    ],
                    fromListening: [
                        { w: "Relax", p: "/rÉªËˆlÃ¦ks/", context: "Watching movies helps me relax." },
                        { w: "Active", p: "/ËˆÃ¦ktÉªv/", context: "An active lifestyle is healthy." },
                        { w: "Routine", p: "/ruËËˆtiËn/", context: "A morning exercise routine." },
                        { w: "Interest", p: "/ËˆÉªntrÉ™st/", context: "Conflict of interest among stakeholders." },
                        { w: "Balance", p: "/ËˆbÃ¦lÉ™ns/", context: "Work-life balance is important." }
                    ]
                },
                4: {
                    type: "grammar",
                    title: "Grammar Focus: Have + Noun & Do + Activity",
                    theory: "DÃ¹ng 'have + danh tá»«' Ä‘á»ƒ nÃ³i vá» nhá»¯ng gÃ¬ báº¡n sá»Ÿ há»¯u hoáº·c cÃ³ trong cuá»™c sá»‘ng. DÃ¹ng 'do + hoáº¡t Ä‘á»™ng' Ä‘á»ƒ mÃ´ táº£ sá»Ÿ thÃ­ch. Cáº¥u trÃºc nÃ y xuáº¥t hiá»‡n ráº¥t nhiá»u trong IELTS Speaking 'Hobbies & Free Time'.",
                    formula: "I have + [Noun] | I do + [Activity]",
                    examples: [
                        { context: "ğŸŒ± Daily", sentence: "I **do** yoga and **have** a walk every morning.", note: "'Do yoga' = hoáº¡t Ä‘á»™ng, 'have a walk' = thÃ nh ngá»¯ cá»‘ Ä‘á»‹nh." },
                        { context: "ğŸ“ MIS", sentence: "The team **does** a sprint review and **has** a demo session weekly.", note: "MÃ´ táº£ hoáº¡t Ä‘á»™ng Agile cá»§a nhÃ³m." }
                    ],
                    exercise: "Ká»ƒ tá»‡n 3 sá»Ÿ thÃ­ch cá»§a báº¡n dÃ¹ng 'I do...' vÃ  3 thá»© báº¡n cÃ³ dÃ¹ng 'I have...'."
                }
            },
            "p1-w1-d5": {
                summary: {
                    topic: "Motivation (IELTS) | Requirement Elicitation (MIS)",
                    grammar: "Want to / Need to / Have to - Diá»…n Ä‘áº¡t mong muá»‘n & nhu cáº§u",
                    pronunciation: "/Î¸/ vs /Ã°/ | Connected: Thank you, With us",
                    listening: "VOA: Digital Revolution",
                    speaking: "Learning Passion & Elicitation (4-Tier Framework)",
                    vocab: "25 words (Trace, Verify, Prioritize, Spec...)"
                },
                0: {
                    type: "pronunciation",
                    title: "PhÃ¡t Ã¢m /Î¸/ vs /Ã°/ (Thin/This)",
                    dailyWords: [
                        { w: "Think", p: "/Î¸ÉªÅ‹k/" }, { w: "This", p: "/Ã°Éªs/" }, { w: "Thank", p: "/Î¸Ã¦Å‹k/" },
                        { w: "That", p: "/Ã°Ã¦t/" }, { w: "Thing", p: "/Î¸ÉªÅ‹/" }, { w: "Those", p: "/Ã°É™ÊŠz/" },
                        { w: "Thin", p: "/Î¸Éªn/" }, { w: "There", p: "/Ã°eÉ™/" }, { w: "Three", p: "/Î¸riË/" }, { w: "They", p: "/Ã°eÉª/" }
                    ],
                    specializedWords: [
                        { w: "Method", p: "/ËˆmeÎ¸É™d/" }, { w: "Gather", p: "/ËˆÉ¡Ã¦Ã°É™/" }, { w: "Theory", p: "/ËˆÎ¸ÉªÉ™ri/" },
                        { w: "Together", p: "/tÉ™ËˆÉ¡eÃ°É™/" }, { w: "Path", p: "/pÉ‘ËÎ¸/" }, { w: "Further", p: "/ËˆfÉœËÃ°É™/" },
                        { w: "Auth", p: "/É”ËÎ¸/" }, { w: "Algorithm", p: "/ËˆÃ¦lÉ¡É™rÉªÃ°É™m/" }, { w: "Theme", p: "/Î¸iËm/" }, { w: "Other", p: "/ËˆÊŒÃ°É™/" }
                    ],
                    connectedSpeech: [
                        { text: "Think about", linking: "/Î¸ÉªÅ‹k É™ËˆbaÊŠt/", type: "Ná»‘i Ã¢m", note: "Ná»‘i /k/ vá»›i /É™/." },
                        { text: "This is", linking: "/Ã°ÉªsÉªz/", type: "Ná»‘i Ã¢m", note: "Ná»‘i /s/ vá»›i /Éª/." },
                        { text: "Thank you", linking: "/Î¸Ã¦Å‹k juË/", type: "Ná»‘i Ã¢m", note: "Ná»‘i /k/ vá»›i /j/." },
                        { text: "With us", linking: "/wÉªÃ° ÊŒs/", type: "Ná»‘i Ã¢m", note: "Ná»‘i /Ã°/ vá»›i /ÊŒ/." },
                        { text: "Both of", linking: "/bÉ™ÊŠÎ¸ É™v/", type: "Ná»‘i Ã¢m", note: "Ná»‘i /Î¸/ vá»›i /É™/." }
                    ],
                    steps: [
                        { num: 1, text: "Xem Video: 'Pronunciation of /Î¸/ vs /Ã°/'", link: "https://www.youtube.com/watch?v=F3XyY3e7u1E" },
                        { num: 2, text: "Luyá»‡n Connected Speech: 'Thank you' vÃ  'This is'." }
                    ]
                },
                1: {
                    type: "listening",
                    title: "VOA: Digital Transformation",
                    steps: [
                        { num: 1, text: "Nghe vá» cÃ¡ch cÃ´ng nghá»‡ thay Ä‘á»•i tháº¿ giá»›i (VOA):", link: "https://learningenglish.voanews.com/a/lets-learn-english-lesson-51-a-good-habit/3818815.html" },
                        { num: 2, text: "Dá»± phÃ²ng (YouTube):", link: "https://www.youtube.com/watch?v=5V_lP6W9J9Y" },
                        { num: 3, text: "Note 5 Ä‘á»™ng tá»« mÃ´ táº£ sá»± thay Ä‘á»•i." }
                    ]
                },
                2: {
                    type: "speaking", title: "Motivation & Elicitation (4-Tier Focus)",
                    scenarios: [
                        {
                            title: "ğŸŒ± Daily Context: Learning Motivation",
                            questions: ["Why do you want to learn English?", "What is your target?"],
                            samples: `**Opinion:** I believe mastering English is a game-changer for my career.
**Reason:** Most advanced MIS documentation and global certifications are in English.
**Example:** For instance, reading BABOK or attending AWS webinars requires professional English.
**Therefore:** I'm aiming for an IELTS 7.0 to unlock global opportunities.`
                        },
                        {
                            title: "ğŸ“ Professional Context: Requirements Elicitation",
                            questions: ["How do you gather user needs?", "What are the common challenges?"],
                            samples: `**Opinion:** Facilitating workshops is the most effective elicitation method.
**Reason:** It brings all stakeholders together to resolve conflicting requirements.
**Example:** I recently managed a session to define user roles for a new portal.
**Therefore:** It ensures the requirements are complete, clear, and verified by everyone.`
                        }
                    ]
                },
                3: {
                    type: "vocabulary", title: "Feelings & Requirements (25 words)",
                    core: [
                        { w: "Think", p: "/Î¸ÉªÅ‹k/", s: "Think twice.", a: "Critical thinking is a key soft skill for BAs." },
                        { w: "Happy", p: "/ËˆhÃ¦pi/", s: "Happy users.", a: "User satisfaction is a primary project goal." },
                        { w: "Hope", p: "/hÉ™ÊŠp/", s: "I hope so.", a: "We hope to reduce system latency by 20%." },
                        { w: "Wish", p: "/wÉªÊƒ/", s: "Best wishes.", a: "A 'wish list' of features often exceeds the budget." },
                        { w: "Feel", p: "/fiËl/", s: "Feel good.", a: "BAs must have empathy to feel user pain points." },
                        { w: "Care", p: "/keÉ™/", s: "Care for it.", a: "Data care and ethics are rising concerns." },
                        { w: "Need", p: "/niËd/", s: "Urgent need.", a: "Business needs are translated into technical specs." },
                        { w: "Fear", p: "/fÉªÉ™/", s: "No fear.", a: "Fear of change is a common stakeholder barrier." },
                        { w: "Love", p: "/lÊŒv/", s: "I love tech.", a: "Users love the simple interface design." },
                        { w: "Hate", p: "/heÉªt/", s: "I hate rain.", a: "Developers hate working with ambiguous requirements." }
                    ],
                    specialized: [
                        { w: "Requirement", p: "/rÉªËˆkwaÉªÉ™mÉ™nt/", s: "Legal requirement.", a: "Requirements are the foundation of any system." },
                        { w: "Elicitation", p: "/ÉªËŒlÉªsÉªËˆteÉªÊƒn/", s: "Technique name.", a: "Elicitation is more than just 'gathering' information." },
                        { w: "Verify", p: "/ËˆverÉªfaÉª/", s: "Verify identity.", a: "We verify requirements to ensure they are accurate." },
                        { w: "Prioritize", p: "/praÉªËˆÉ’rÉ™taÉªz/", s: "Prioritize tasks.", a: "Use MoSCoW to prioritize the product backlog." },
                        { w: "Trace", p: "/treÉªs/", s: "Trace the path.", a: "Traceability links requirements to test results." },
                        { w: "Gap", p: "/É¡Ã¦p/", s: "A small gap.", a: "Gap analysis identifies current vs future states." },
                        { w: "Valid", p: "/ËˆvÃ¦lÉªd/", s: "Valid data.", a: "Input validation prevents system errors." },
                        { w: "Detail", p: "/ËˆdiËteÉªl/", s: "Fine detail.", a: "The FSD contains all technical details." },
                        { w: "Spec", p: "/spek/", s: "Check specs.", a: "Functional specs define system capabilities." },
                        { w: "Theme", p: "/Î¸iËm/", s: "Main theme.", a: "Epics and themes help organize large project scopes." }
                    ],
                    fromListening: [
                        { w: "Digital", p: "/ËˆdÉªdÊ’Éªtl/", context: "The digital transformation of banking." },
                        { w: "Device", p: "/dÉªËˆvaÉªs/", context: "Connected IoT devices in a smart city." },
                        { w: "App", p: "/Ã¦p/", context: "Downloading a new enterprise app." },
                        { w: "Innovation", p: "/ËŒnÉ™ËˆveÉªÊƒn/", context: "Fostering innovation in IT teams." },
                        { w: "Improve", p: "/ÉªmËˆpruËv/", context: "Continuous improvement of processes." }
                    ]
                },
                4: {
                    type: "grammar",
                    title: "Grammar Focus: Want to / Need to / Have to",
                    theory: "Bá»™ ba 'want to', 'need to', 'have to' biá»ƒu Ä‘áº¡t má»©c Ä‘á»™ mong muá»‘n khÃ¡c nhau. 'Want to' = mong muá»‘n cÃ¡ nhÃ¢n. 'Need to' = cáº§n thiáº¿t thá»±c táº¿. 'Have to' = báº¯t buá»™c (ngoáº¡i lá»±c).",
                    formula: "S + want to / need to / have to + V (nguyÃªn máº«u)",
                    examples: [
                        { context: "ğŸŒ± Daily", sentence: "I **want to** improve my English to reach IELTS 7.0.", note: "Mong muá»‘n máº¡nh máº½ tá»« bÃªn trong." },
                        { context: "ğŸ“ MIS", sentence: "BAs **need to** verify all requirements before the sprint begins.", note: "Nhu cáº§u cÃ³ tÃ­nh cháº¥t báº¯t buá»™c trong quy trÃ¬nh." }
                    ],
                    exercise: "Viáº¿t 1 cÃ¢u cho má»—i loáº¡i: want to / need to / have to liÃªn quan Ä‘áº¿n má»¥c tiÃªu há»c tiáº¿ng Anh cá»§a báº¡n."
                }
            },
            "p1-w1-d6": {
                summary: {
                    topic: "Travel (IELTS) | Data & Infrastructure Basics (MIS)",
                    grammar: "Can / Can't - Kháº£ nÄƒng & Há»‡ thá»‘ng IT",
                    pronunciation: "/ÊŠ/ vs /uË/ | Connected: Good at, Two hours",
                    listening: "BBC: Future Transport",
                    speaking: "Past Trips & Analytics (4-Tier)",
                    vocab: "25 words (Data, Database, Query, Table...)"
                },
                0: {
                    type: "pronunciation",
                    title: "PhÃ¡t Ã¢m /ÊŠ/ vs /uË/ (Book/Boot)",
                    dailyWords: [{ w: "Book", p: "/bÊŠk/" }, { w: "Boot", p: "/buËt/" }],
                    specializedWords: [{ w: "Input", p: "/ËˆÉªnpÊŠt/" }, { w: "Execute", p: "/ËˆeksÉªkjuËt/" }],
                    connectedSpeech: [
                        { text: "Good at", linking: "/É¡ÊŠdÃ¦t/", type: "Ná»‘i Ã¢m" },
                        { text: "Two hours", linking: "/tuË waÊŠÉ™z/", type: "Ná»‘i Ã¢m" }
                    ],
                    steps: [{ num: 1, text: "Luyá»‡n phÃ¡t Ã¢m cáº·p pull - pool, full - fool." }]
                },
                1: {
                    type: "listening",
                    title: "BBC: Future Transport",
                    steps: [
                        { num: 1, text: "Transport of the future (BBC):", link: "https://www.bbc.co.uk/learningenglish/english/features/6-minute-english/ep-180208" },
                        { num: 2, text: "Dá»± phÃ²ng (YouTube):", link: "https://www.youtube.com/watch?v=rX_mO_Q5qN0" },
                        { num: 3, text: "Note cá»¥m tá»« vá» Infrastructure vÃ  Transport." }
                    ]
                },
                2: {
                    type: "speaking", title: "Travel & Data Analytics (4-Tier Focus)",
                    scenarios: [
                        {
                            title: "ğŸŒ± Daily Context: Past Traveling",
                            questions: ["Describe a trip you took recently."],
                            samples: `**Opinion:** My recent trip to Da Nang was incredibly refreshing.
**Reason:** I needed to escape the city noise and enjoy the sea.
**Example:** Relaxing at My Khe beach and eating seafood helped me de-stress.
**Therefore:** It was the perfect break before starting a new project.`
                        },
                        {
                            title: "ğŸ“ Professional Context: Data & Analytics",
                            questions: ["How does your company use data?"],
                            samples: `**Opinion:** Data is the backbone of our decision-making process.
**Reason:** It provides objective insights rather than relying on guesswork.
**Example:** We analyze user behavior data to optimize the app's navigation.
**Therefore:** Using analytics consistently leads to a better user experience.`
                        }
                    ]
                },
                3: {
                    type: "vocabulary", title: "Travel & Data Mastery (25 words)",
                    core: [
                        { w: "Travel", p: "/ËˆtrÃ¦vl/", s: "Frequent travel.", a: "Data travel time is critical for system performance." },
                        { w: "Safe", p: "/seÉªf/", s: "Safe trip.", a: "Keep the backup in a safe, off-site location." }
                    ],
                    specialized: [
                        { w: "Database", p: "/ËˆdeÉªtÉ™beÉªs/", s: "SQL Database.", a: "A relational database ensures data integrity." },
                        { w: "Query", p: "/ËˆkwÉªÉ™ri/", s: "SQL query.", a: "Optimizing queries speeds up the dashboard." }
                    ],
                    fromListening: [{ w: "Destination", p: "/ËŒdestÉªËˆneÉªÊƒn/", context: "Hanoi is a top tourist destination." }]
                },
                4: {
                    type: "grammar",
                    title: "Grammar Focus: Can / Can't",
                    theory: "'Can' diá»…n táº£ kháº£ nÄƒng, sá»± cho phÃ©p hoáº·c nÄƒng lá»±c cá»§a há»‡ thá»‘ng. 'Can't' lÃ  phá»§ Ä‘á»‹nh. Modal verb nÃ y khÃ´ng cáº§n thÃªm '-s' vá»›i chá»§ ngá»¯ sá»‘ Ã­t.",
                    formula: "S + can + V (nguyÃªn máº«u, khÃ´ng 'to')",
                    examples: [
                        { context: "ğŸŒ± Daily", sentence: "I **can** speak English and Vietnamese fluently.", note: "Diá»…n táº£ kháº£ nÄƒng ngÃ´n ngá»¯." },
                        { context: "ğŸ“ MIS", sentence: "The system **can** process 10,000 transactions per second.", note: "MÃ´ táº£ nÄƒng lá»±c xá»­ lÃ½ cá»§a há»‡ thá»‘ng." }
                    ],
                    exercise: "Viáº¿t 3 cÃ¢u báº¡n 'can do' vÃ  1 cÃ¢u báº¡n 'can't do yet' liÃªn quan Ä‘áº¿n tiáº¿ng Anh."
                }
            },
            "p1-w1-d7": {
                summary: {
                    topic: "Weekly Review | Mock Test 1 (Foundation)",
                    grammar: "Review: Be / Have / Do / Can - Tá»•ng Ã´n Tuáº§n 1",
                    pronunciation: "Master 12 Vowels | Video Challenge",
                    listening: "Deep Dictation (Tech & Jobs)",
                    speaking: "Full Part 1 Simulation",
                    vocab: "150-Word Audit (Core + MIS)"
                },
                0: {
                    type: "pronunciation",
                    title: "IPA Review: 12 Vowels Mastery",
                    steps: [{ num: 1, text: "Review all pairs from Day 1 to Day 6." }, { num: 2, text: "Record a video of yourself reading 30 key terms." }]
                },
                1: {
                    type: "listening",
                    title: "Mock Listening: Foundation Review",
                    steps: [{ num: 1, text: "Listen to the 'MIS Overview' clip and dictate the first 60 seconds." }]
                },
                2: {
                    type: "speaking",
                    title: "Mock Speaking Test: Phase 1 Part 1",
                    scenarios: [{ title: "ğŸ”¥ Full Part 1 Simulation", questions: ["Study/Work", "Routine", "Hobbies", "Future Plans"], samples: "Apply the 4-Tier Framework (Opinion, Reason, Example, Therefore) to at least 3 answers." }]
                },
                3: {
                    type: "vocabulary",
                    title: "Weekly Vocab Audit (150 Words)",
                    core: [{ w: "Review", p: "/rÉªËˆvjuË/", s: "Weekly review.", a: "Reviewing requirements prevents costly rework." }],
                    specialized: [{ w: "Audit", p: "/ËˆÉ”ËdÉªt/", s: "Internal audit.", a: "BAs often audit processes to find bottlenecks." }]
                },
                4: {
                    type: "grammar",
                    title: "Grammar Review: Be / Have / Do / Can",
                    theory: "Tá»•ng Ã´n 4 Ä‘á»™ng tá»« ná»n táº£ng cá»§a Tuáº§n 1. ÄÃ¢y lÃ  'bá»™ tá»© vÅ© khÃ­' giÃºp báº¡n xÃ¢y dá»±ng má»i cÃ¢u cÆ¡ báº£n trong tiáº¿ng Anh.",
                    formula: "I am | I have | I do | I can",
                    examples: [
                        { context: "ğŸŒ± Daily", sentence: "I **am** a learner, I **have** a plan, I **do** my best, and I **can** improve.", note: "DÃ¹ng cáº£ 4 trong 1 cÃ¢u phá»©c há»£p." },
                        { context: "ğŸ“ MIS", sentence: "The BA **is** experienced, **has** domain knowledge, **does** gap analysis, and **can** model processes.", note: "MÃ´ táº£ toÃ n diá»‡n vai trÃ² BA." }
                    ],
                    exercise: "Viáº¿t 1 Ä‘oáº¡n vÄƒn ngáº¯n (4-5 cÃ¢u) sá»­ dá»¥ng cáº£ 4 Ä‘á»™ng tá»«: am/is/are, have/has, do/does, can. Chá»§ Ä‘á»: 'Táº¡i sao báº¡n há»c IELTS?'."
                }
            },
            "p1-w2-d1": {
                summary: {
                    topic: "Family & Home (IELTS) | Org Structure (MIS)",
                    grammar: "Simple Present: S + V(s/es) - MÃ´ táº£ sá»± tháº­t & thÃ³i quen",
                    pronunciation: "/eÉª/ & /aÉª/ | Connected: Take away, My own",
                    listening: "VOA: The Modern Family",
                    speaking: "Family & Hierarchy (4-Tier Focus)",
                    vocab: "25 words (Parent, Child, CEO, Level...)"
                },
                0: {
                    type: "pronunciation",
                    title: "PhÃ¡t Ã¢m /eÉª/ - /aÉª/ (Diphthongs)",
                    dailyWords: [{ w: "Take", p: "/teÉªk/" }, { w: "Time", p: "/taÉªm/" }],
                    specializedWords: [{ w: "State", p: "/steÉªt/" }, { w: "Design", p: "/dÉªËˆzaÉªn/" }],
                    connectedSpeech: [{ text: "Take a break", linking: "/teÉªkÉ™breÉªk/", type: "Ná»‘i Ã¢m" }]
                },
                1: {
                    type: "listening", title: "VOA: Family Dynamics", steps: [
                        { num: 1, text: "VOA Lesson 12: Family Roles (VOA):", link: "https://learningenglish.voanews.com/a/lets-learn-english-lesson-12-meet-my-family/3277764.html" },
                        { num: 2, text: "Dá»± phÃ²ng (YouTube):", link: "https://www.youtube.com/watch?v=yW99n3x8N0k" }
                    ]
                },
                2: {
                    type: "speaking", title: "Family & Hierarchy (4-Tier Focus)",
                    scenarios: [
                        { title: "ğŸŒ± Daily: Family", questions: ["Describe your family."], samples: "Opinion: I have a nuclear family. Reason: Closely-knit. therefore: Supportive." },
                        { title: "ğŸ“ Professional: Hierarchy", questions: ["Describe your team structure."], samples: "Opinion: We have a flat structure. Reason: Faster decision-making. Therefore: Agile." }
                    ]
                },
                3: {
                    type: "vocabulary", title: "Family & Org (25 words)",
                    core: [{ w: "Relative", p: "/ËˆrelÉ™tÉªv/", s: "Blood relative.", a: "A relative path is used in file systems." }],
                    specialized: [{ w: "Hierarchy", p: "/ËˆhaÉªÉ™rÉ‘Ëki/", s: "Corporate hierarchy.", a: "MIS roles follow a strict hierarchy." }],
                    fromListening: [{ w: "Nuclear", p: "/ËˆnjuËkliÉ™/", context: "Nuclear family vs extended." }]
                },
                4: {
                    type: "grammar",
                    title: "Grammar Focus: Simple Present - S + V(s/es)",
                    theory: "ThÃ¬ hiá»‡n táº¡i Ä‘Æ¡n diá»…n táº£ sá»± tháº­t hiá»ƒn nhiÃªn, thÃ³i quen, hoáº·c Ä‘áº·c Ä‘iá»ƒm láº­p láº¡i. Vá»›i chá»§ ngá»¯ He/She/It pháº£i thÃªm '-s' hoáº·c '-es' vÃ o Ä‘á»™ng tá»«.",
                    formula: "I/You/We/They + V | He/She/It + V-s/es",
                    examples: [
                        { context: "ğŸŒ± Daily", sentence: "My mother **cooks** dinner every evening.", note: "'Cooks' = V + s vÃ¬ chá»§ ngá»¯ lÃ  'My mother' (she)." },
                        { context: "ğŸ“ MIS", sentence: "The system **processes** each request within 200ms.", note: "MÃ´ táº£ hiá»‡u suáº¥t Ä‘á»‹nh ká»³." }
                    ],
                    exercise: "Viáº¿t 3 cÃ¢u vá» thÃ³i quen hÃ ng ngÃ y cá»§a báº¡n. DÃ¹ng 'I + V' vÃ  'She/He + V-s'."
                }
            },
            "p1-w2-d2": {
                summary: {
                    topic: "Accommodation (IELTS) | Hardware & Infrastructure (MIS)",
                    grammar: "Simple Present: There is/are... - MÃ´ táº£ Ä‘á»“ váº­t & há»‡ thá»‘ng",
                    pronunciation: "/É”Éª/ & /É™ÊŠ/ | Connected: Boy and, Go out",
                    listening: "BBC: Smart Homes",
                    speaking: "House & Tech Inventory (4-Tier)",
                    vocab: "25 words (Server, Client, Host, Port...)"
                },
                0: {
                    type: "pronunciation",
                    title: "PhÃ¡t Ã¢m /É”Éª/ - /É™ÊŠ/ (Diphthongs)",
                    dailyWords: [{ w: "Boy", p: "/bÉ”Éª/" }, { w: "Go", p: "/É¡É™ÊŠ/" }],
                    specializedWords: [{ w: "Deploy", p: "/dÉªËˆplÉ”Éª/" }, { w: "Code", p: "/kÉ™ÊŠd/" }],
                    connectedSpeech: [{ text: "Go on", linking: "/É¡É™ÊŠwÉ’n/", type: "Ná»‘i Ã¢m" }]
                },
                1: {
                    type: "listening", title: "BBC: Digital Living", steps: [
                        { num: 1, text: "Smart tech and climate change (BBC):", link: "https://www.bbc.co.uk/learningenglish/features/6-minute-english/ep-211007" },
                        { num: 2, text: "Dá»± phÃ²ng (YouTube):", link: "https://www.youtube.com/watch?v=O14AOnK7LIA" }
                    ]
                },
                2: {
                    type: "speaking", title: "House & Hardware (4-Tier Focus)",
                    scenarios: [
                        { title: "ğŸŒ± Daily: Describe House", questions: ["Tell me about your house."], samples: "Opinion: My flat is cozy. Reason: Smart layout. Therefore: I love stay home." },
                        { title: "ğŸ“ Professional: Infrastructure", questions: ["What hardware do you use?"], samples: "Opinion: High-end servers are vital. Reason: High traffic. Therefore: Reliability." }
                    ]
                },
                3: {
                    type: "vocabulary", title: "Hardware & Housing (25 words)",
                    core: [{ w: "Window", p: "/ËˆwÉªndÉ™ÊŠ/", s: "Open windows.", a: "Operating system window management." }],
                    specialized: [{ w: "Server", p: "/ËˆsÉœËvÉ™/", s: "Main server.", a: "Clients must authenticate with the server." }],
                    fromListening: [{ w: "Appliance", p: "/É™ËˆplaÉªÉ™ns/", context: "Smart household appliances." }]
                },
                4: {
                    type: "grammar",
                    title: "Grammar Focus: There is / There are",
                    theory: "DÃ¹ng 'There is' + danh tá»« sá»‘ Ã­t Ä‘á»ƒ thÃ´ng bÃ¡o sá»± tá»“n táº¡i cá»§a má»™t váº­t. DÃ¹ng 'There are' + danh tá»« sá»‘ nhiá»u. Ráº¥t phá»• biáº¿n khi mÃ´ táº£ cÄƒn phÃ²ng, Ä‘á»‹a Ä‘iá»ƒm, hay kiáº¿n trÃºc há»‡ thá»‘ng.",
                    formula: "There is + [N sá»‘ Ã­t] | There are + [N sá»‘ nhiá»u]",
                    examples: [
                        { context: "ğŸŒ± Daily", sentence: "**There is** a coffee shop near my house.", note: "MÃ´ táº£ sá»± tá»“n táº¡i cá»§a 1 Ä‘á»‹a Ä‘iá»ƒm." },
                        { context: "ğŸ“ MIS", sentence: "**There are** three servers in our data center.", note: "MÃ´ táº£ cáº¥u hÃ¬nh háº¡ táº§ng IT." }
                    ],
                    exercise: "MÃ´ táº£ phÃ²ng há»c/vÄƒn phÃ²ng cá»§a báº¡n báº±ng 3 cÃ¢u There is/are."
                }
            },
            "p1-w2-d3": {
                summary: {
                    topic: "Housework (IELTS) | Roles & Accountabilities (MIS)",
                    grammar: "Simple Present: Frequency Adverbs (always/usually/often) - Táº§n suáº¥t",
                    pronunciation: "/aÊŠ/ & /ÉªÉ™/ | Connected: How about, Clear it",
                    listening: "VOA: Home Life Tasks",
                    speaking: "Helping & RACI (4-Tier)",
                    vocab: "25 words (Owner, Expert, Vendor, Admin...)"
                },
                0: {
                    type: "pronunciation",
                    title: "PhÃ¡t Ã¢m /aÊŠ/ - /ÉªÉ™/ (Diphthongs)",
                    dailyWords: [{ w: "How", p: "/haÊŠ/" }, { w: "Ear", p: "/ÉªÉ™/" }],
                    specializedWords: [{ w: "Auth", p: "/É”ËÎ¸/" }, { w: "Engineer", p: "/ËŒendÊ’ÉªËˆnÉªÉ™/" }]
                },
                1: {
                    type: "listening", title: "VOA: Daily Responsibilities", steps: [
                        { num: 1, text: "Listen for chore verbs (VOA):", link: "https://learningenglish.voanews.com/a/lets-learn-english-lesson-14-how-about-this/3313264.html" },
                        { num: 2, text: "Dá»± phÃ²ng (YouTube):", link: "https://www.youtube.com/watch?v=R9_mQ_Q5qN0" }
                    ]
                },
                2: {
                    type: "speaking", title: "Responsibilities (4-Tier Focus)",
                    scenarios: [
                        { title: "ğŸŒ± Daily: Housework", questions: ["Do you do housework?"], samples: "Opinion: I help out daily. Reason: Shared responsibility. Therefore: Clean home." },
                        { title: "ğŸ“ Professional: Accountabilities", questions: ["What is your role?"], samples: "Opinion: BAs are accountable for requirements. Reason: Accuracy. Therefore: Success." }
                    ]
                },
                3: {
                    type: "vocabulary", title: "Roles & Tasks (25 words)",
                    core: [{ w: "Helper", p: "/ËˆhelpÉ™/", s: "Good helper.", a: "Helper functions simplify the code." }],
                    specialized: [{ w: "Accountable", p: "/É™ËˆkaÊŠntÉ™bl/", s: "Stay accountable.", a: "RACI matrix defines accountability." }],
                    fromListening: [{ w: "Routine", p: "/ruËËˆtiËn/", context: "Daily housework routine." }]
                },
                4: {
                    type: "grammar",
                    title: "Grammar Focus: Frequency Adverbs (always/usually/often)",
                    theory: "Táº§n suáº¥t tráº¡ng tá»« Ä‘áº·t sau chá»§ ngá»¯ nhÆ°ng TRÆ¯á»šC Ä‘á»™ng tá»« chÃ­nh. Ráº¥t há»¯u dá»¥ng Ä‘á»ƒ mÃ´ táº£ thÃ³i quen trong IELTS Part 1.",
                    formula: "S + always/usually/often/sometimes/rarely/never + V",
                    examples: [
                        { context: "ğŸŒ± Daily", sentence: "I **always** review my vocabulary before sleeping.", note: "'Always' = 100%, Ä‘áº·t trÆ°á»›c Ä‘á»™ng tá»«." },
                        { context: "ğŸ“ MIS", sentence: "Our team **usually** holds a sprint planning meeting on Monday.", note: "'Usually' = thÆ°á»ng xuyÃªn nhÆ°ng khÃ´ng pháº£i lÃºnc nÃ o." }
                    ],
                    exercise: "Viáº¿t 5 cÃ¢u vá» cÃ¡c thÃ³i quen há»c IELTS cá»§a báº¡n, má»—i cÃ¢u dÃ¹ng 1 tráº¡ng tá»« táº§n suáº¥t khÃ¡c nhau."
                }
            },
            "p1-w2-d4": {
                summary: {
                    topic: "Hometown (IELTS) | Location & Hosting (MIS)",
                    grammar: "Simple Present: Wh- Questions (Where/What/Who) - Há»i vá» Ä‘á»‹a Ä‘iá»ƒm",
                    pronunciation: "/eÉ™/ & /ÊŠÉ™/ | Connected: Where are, Sure of",
                    listening: "BBC: Cities of the Future",
                    speaking: "Hometown & Data Centers (4-Tier)",
                    vocab: "25 words (Region, District, Cloud, On-premise...)"
                },
                0: {
                    type: "pronunciation",
                    title: "PhÃ¡t Ã¢m /eÉ™/ - /ÊŠÉ™/ (Diphthongs)",
                    dailyWords: [{ w: "Where", p: "/weÉ™/" }, { w: "Sure", p: "/ÊƒÊŠÉ™/" }],
                    specializedWords: [{ w: "Area", p: "/ËˆeÉ™riÉ™/" }, { w: "Secure", p: "/sÉªËˆkjÊŠÉ™/" }]
                },
                1: {
                    type: "listening", title: "BBC: Urban Growth", steps: [
                        { num: 1, text: "Cities of the future (BBC):", link: "https://www.bbc.co.uk/learningenglish/english/features/6-minute-english/ep-160714" },
                        { num: 2, text: "Dá»± phÃ²ng (YouTube):", link: "https://www.youtube.com/watch?v=Je_EAs69K-I" }
                    ]
                },
                2: {
                    type: "speaking", title: "Locations (4-Tier Focus)",
                    scenarios: [
                        { title: "ğŸŒ± Daily: Hometown", questions: ["Where is your hometown?"], samples: "Opinion: Hanoi is vibrant. Reason: Capital city. Therefore: Lots of opportunities." },
                        { title: "ğŸ“ Professional: Cloud vs On-Prem", questions: ["Where is your data stored?"], samples: "Opinion: We prefer Cloud hosting. Reason: Scalability. Therefore: Cost-effective." }
                    ]
                },
                3: {
                    type: "vocabulary", title: "Location & Cloud (25 words)",
                    core: [{ w: "Place", p: "/pleÉªs/", s: "Nice place.", a: "Place the files in the shared drive." }],
                    specialized: [{ w: "Hosting", p: "/ËˆhÉ™ÊŠstÉªÅ‹/", s: "Cloud hosting.", a: "Hosting costs are part of the OpEx." }],
                    fromListening: [{ w: "Landscape", p: "/ËˆlÃ¦ndskeÉªp/", context: "Competitive tech landscape." }]
                },
                4: {
                    type: "grammar",
                    title: "Grammar Focus: Wh- Questions",
                    theory: "CÃ¢u há»i Wh- báº¯t Ä‘áº§u báº±ng What / Where / Who / When / Why / How. ÄÃ¢y lÃ  ná»n táº£ng Ä‘á»ƒ há»i thÃ´ng tin cá»¥ thá»ƒ vÃ  lÃ  ká»¹ nÄƒng cá»‹t lÃµi trong IELTS Speaking Part 1.",
                    formula: "Wh- word + do/does + S + V? | Wh- word + is/are + S?",
                    examples: [
                        { context: "ğŸŒ± Daily", sentence: "**Where do** you usually go at the weekend?", note: "'Where' + 'do' + chá»§ ngá»¯ + Ä‘á»™ng tá»«." },
                        { context: "ğŸ“ MIS", sentence: "**What is** the SLA threshold for this API endpoint?", note: "Há»i vá» chá»‰ sá»‘ ká»¹ thuáº­t." }
                    ],
                    exercise: "Viáº¿t 5 cÃ¢u há»i Wh- Ä‘á»ƒ há»i vá» thÃ nh phá»‘ / vÄƒn phÃ²ng cá»§a báº¡n."
                }
            },
            "p1-w2-d5": {
                summary: {
                    topic: "Neighborhood (IELTS) | Environment & Ecology (MIS)",
                    grammar: "Simple Present: Negative (don't/doesn't) - Phá»§ Ä‘á»‹nh",
                    pronunciation: "Ending Sounds /s/ /z/ /Éªz/ | Connected: This is, Phases",
                    listening: "VOA: Green Technology",
                    speaking: "My Area & Green IT (4-Tier)",
                    vocab: "25 words (Safe, Busy, Green, Sustain...)"
                },
                0: {
                    type: "pronunciation",
                    title: "Ending Sounds /s/ /z/ /Éªz/",
                    dailyWords: [{ w: "Places", p: "/ËˆpleÉªsÉªz/" }, { w: "Works", p: "/wÉœËks/" }],
                    specializedWords: [{ w: "Releases", p: "/rÉªËˆliËsÉªz/" }, { w: "Users", p: "/ËˆjuËzÉ™z/" }]
                },
                1: {
                    type: "listening", title: "VOA: Sustainable Tech", steps: [
                        { num: 1, text: "Watch for green MIS terms (VOA):", link: "https://learningenglish.voanews.com/a/lets-learn-english-lesson-51-a-good-habit/3818815.html" },
                        { num: 2, text: "Dá»± phÃ²ng (YouTube):", link: "https://www.youtube.com/watch?v=5V_lP6W9J9Y" }
                    ]
                },
                2: {
                    type: "speaking", title: "Environment (4-Tier Focus)",
                    scenarios: [
                        { title: "ğŸŒ± Daily: Neighborhood", questions: ["Is your area good?"], samples: "Opinion: It's very convenient. Reason: Near shops. Therefore: Saves time." },
                        { title: "ğŸ“ Professional: Green IT", questions: ["How to save energy in IT?"], samples: "Opinion: Server virtualization is key. Reason: Fewer machines. Therefore: Less carbon footprint." }
                    ]
                },
                3: {
                    type: "vocabulary", title: "Area & Sustainability (25 words)",
                    core: [{ w: "Quiet", p: "/ËˆkwaÉªÉ™t/", s: "Quiet street.", a: "System quiet hours for maintenance." }],
                    specialized: [{ w: "Virtualization", p: "/ËŒvÉœËrtÊƒuÉ™lÉ™ËˆzeÉªÊƒn/", s: "Server virt.", a: "Virtualization optimizes hardware usage." }],
                    fromListening: [{ w: "Biodiversity", p: "/ËŒbaÉªÉ™ÊŠdaÉªËˆvÉœËrsÉ™ti/", context: "Impact on biodiversity." }]
                },
                4: {
                    type: "grammar",
                    title: "Grammar Focus: Simple Present Negative (don't / doesn't)",
                    theory: "Phá»§ Ä‘á»‹nh thÃ¬ hiá»‡n táº¡i Ä‘Æ¡n dÃ¹ng 'do not (don't)' vá»›i I/You/We/They vÃ  'does not (doesn't)' vá»›i He/She/It. Khi dÃ¹ng 'doesn't', Ä‘á»™ng tá»« chÃ­nh khÃ´ng Ä‘Æ°á»£c thÃªm '-s'.",
                    formula: "S + don't/doesn't + V (nguyÃªn máº«u)",
                    examples: [
                        { context: "ğŸŒ± Daily", sentence: "I **don't** live near the city center.", note: "Phá»§ Ä‘á»‹nh Ä‘Æ¡n giáº£n vá»›i chá»§ ngá»¯ 'I'." },
                        { context: "ğŸ“ MIS", sentence: "Our system **doesn't** support legacy file formats.", note: "MÃ´ táº£ giá»›i háº¡n cá»§a há»‡ thá»‘ng." }
                    ],
                    exercise: "Viáº¿t 4 cÃ¢u phá»§ Ä‘á»‹nh (2 dÃ¹ng don't, 2 dÃ¹ng doesn't) vá» nhá»¯ng Ä‘iá»u báº¡n khÃ´ng lÃ m hÃ ng ngÃ y."
                }
            },
            "p1-w2-d6": {
                summary: {
                    topic: "Week 2 Review | Connected Speech Mastery",
                    grammar: "Review Simple Present: (+) (-) (?) - Tá»•ng Ã´n Tuáº§n 2",
                    pronunciation: "Review 8 Diphthongs | Shadowing Challenge",
                    listening: "BBC: Smart Living Summary",
                    speaking: "Full Part 1 Mock Test",
                    vocab: "Weekly Audit (Accommodation & Org)"
                },
                0: { type: "pronunciation", title: "Review Diphthongs", steps: [{ num: 1, text: "Master 8 glide vowels." }] },
                1: {
                    type: "listening", title: "Review: Internet of Things", steps: [
                        { num: 1, text: "The Internet of Things (BBC):", link: "https://www.bbc.co.uk/learningenglish/english/features/6-minute-english/ep-170323" },
                        { num: 2, text: "Dá»± phÃ²ng (YouTube):", link: "https://www.youtube.com/watch?v=OueO_xIDrS0" }
                    ]
                },
                2: { type: "speaking", title: "Part 1 Mock", scenarios: [{ title: "ğŸ”¥ Full Set", questions: ["Family", "House", "Hometown"], samples: "Focus on fluency and diphthongs." }] },
                3: { type: "vocabulary", title: "Audit", core: [{ w: "Audit", p: "/ËˆÉ”ËdÉªt/", s: "Weekly check.", a: "Audit for progress." }] },
                4: {
                    type: "grammar",
                    title: "Grammar Review: Simple Present (+) (-) (?)",
                    theory: "Tá»•ng Ã´n toÃ n bá»™ Simple Present tuáº§n 2. 3 dáº¡ng: Kháº³ng Ä‘á»‹nh (V/V-s), Phá»§ Ä‘á»‹nh (don't/doesn't + V), Há»i (Do/Does + S + V?).",
                    formula: "(+) S+V | (-) S+don't/doesn't+V | (?) Do/Does+S+V?",
                    examples: [
                        { context: "ğŸŒ± Daily", sentence: "**Does** she **study** English every day? - Yes, she **does**.", note: "CÃ¢u há»i Yes/No vá»›i chá»§ ngá»¯ sá»‘ Ã­t." },
                        { context: "ğŸ“ MIS", sentence: "**Do** BAs **write** the SRS document? - Yes, they **do**.", note: "Tá»¥ng Ã´n vá»i cÃ¢u há»i mÃ´ táº£ quy trÃ¬nh BA." }
                    ],
                    exercise: "Viáº¿t 2 cÃ¢u kháº³ng Ä‘á»‹nh, 2 cÃ¢u phá»§ Ä‘á»‹nh, vÃ  2 cÃ¢u há»i vá» thÃ³i quen há»c IELTS cá»§a báº¡n."
                }
            },
            "p1-w3-d1": {
                summary: {
                    topic: "Work & Study (IELTS) | Daily Stand-up Basics (MIS)",
                    grammar: "Present Continuous (ThÃ¬ hiá»‡n táº¡i tiáº¿p diá»…n)",
                    pronunciation: "/p/, /b/, /t/, /d/ | Connected: What are you doing?",
                    listening: "VOA: What Are You Doing?",
                    speaking: "Present Activities & Stand-ups (4-Tier Focus)",
                    vocab: "25 words (Colleague, Sprint, Backlog, Task...)"
                },
                0: {
                    type: "pronunciation",
                    title: "IPA Consonants 1: /p/, /b/, /t/, /d/",
                    dailyWords: [
                        { w: "Play", p: "/pleÉª/" }, { w: "Big", p: "/bÉªÉ¡/" }, { w: "Task", p: "/tÉ‘Ësk/" }, { w: "Data", p: "/ËˆdeÉªtÉ™/" },
                        { w: "Point", p: "/pÉ”Éªnt/" }, { w: "Best", p: "/best/" }, { w: "Time", p: "/taÉªm/" }, { w: "Done", p: "/dÊŒn/" },
                        { w: "Plan", p: "/plÃ¦n/" }, { w: "Build", p: "/bÉªld/" }
                    ],
                    specializedWords: [
                        { w: "Project", p: "/ËˆprÉ’dÊ’ekt/" }, { w: "Business", p: "/ËˆbÉªznÉ™s/" }, { w: "Tool", p: "/tuËl/" }, { w: "Deliver", p: "/dÉªËˆlÉªvÉ™/" },
                        { w: "Present", p: "/Ëˆpreznt/" }, { w: "Backlog", p: "/ËˆbÃ¦klÉ’É¡/" }, { w: "Ticket", p: "/ËˆtÉªkÉªt/" }, { w: "Dashboard", p: "/ËˆdÃ¦ÊƒbÉ”Ëd/" },
                        { w: "Team", p: "/tiËm/" }, { w: "Design", p: "/dÉªËˆzaÉªn/" }
                    ],
                    connectedSpeech: [
                        { text: "What are you doing?", linking: "/wÉ’tÉ™rijuduËÉªÅ‹/", type: "Biáº¿n Ã¢m", note: "Ã‚m /t/ biáº¿n thÃ nh Ã¢m /r/ nháº¹ (flapping)." },
                        { text: "Working on", linking: "/wÉœËkÉªÅ‹É’n/", type: "Ná»‘i Ã¢m", note: "Ná»‘i phá»¥ Ã¢m cháº·n /Å‹/ sang nguyÃªn Ã¢m /É’/." },
                        { text: "Ask a question", linking: "/É‘ËskÉ™ËˆkwestÊƒÉ™n/", type: "Ná»‘i Ã¢m", note: "Ná»‘i /k/ sang /É™/." },
                        { text: "Send it", linking: "/sendÉªt/", type: "Ná»‘i Ã¢m", note: "Ná»‘i /d/ sang /Éª/." }
                    ],
                    steps: [
                        { num: 1, text: "Xem Video: 'Consonants /p/ /b/ /t/ /d/'", link: "https://www.youtube.com/watch?v=0kIovgBivK0" },
                        { num: 2, text: "Luyá»‡n báº­t hÆ¡i máº¡nh cho /p/ vÃ  /t/." }
                    ]
                },
                1: {
                    type: "listening",
                    title: "VOA: Working Life",
                    steps: [
                        { num: 1, text: "VOA Lesson 7: What Are You Doing? (VOA):", link: "http://learningenglish.voanews.com/a/lets-learn-english-lesson-7-what-are-you-doing/3345754.html" },
                        { num: 2, text: "Dá»± phÃ²ng (YouTube):", link: "https://www.youtube.com/watch?v=R94yvE50I9Q" },
                        { num: 3, text: "Note láº¡i cÃ¡c hÃ nh Ä‘á»™ng Anna tháº¥y Ä‘á»“ng nghiá»‡p Ä‘ang lÃ m." }
                    ]
                },
                2: {
                    type: "speaking", title: "Current Activities (4-Tier Focus)",
                    scenarios: [
                        {
                            title: "ğŸŒ± Daily Context: Working & Studying",
                            questions: ["What are you doing these days?", "How are you improving your English?"],
                            samples: `**Opinion:** I'm currently focusing on my IELTS preparation every morning.
**Reason:** I'm trying to build a solid foundation before taking the actual exam.
**Example:** For instance, I am attending online classes and practicing IPA drills daily.
**Therefore:** This consistent effort is helping me feel more confident in my skills.`
                        },
                        {
                            title: "ğŸ“ Professional Context: The Daily Stand-up",
                            questions: ["What are you working on right now?", "Are there any obstacles?"],
                            samples: `**Opinion:** Right now, I'm analyzing the user backlog for the new app module.
**Reason:** It's important to clarify the requirements before the next sprint starts.
**Example:** I'm currently documenting the functional specs for the login feature.
**Therefore:** I don't have any major blockers at the moment and expect to finish by EOD.`
                        }
                    ]
                },
                3: {
                    type: "vocabulary", title: "Work & Agile Basics (25 words)",
                    core: [
                        { w: "Colleague", p: "/ËˆkÉ’liËÉ¡/", s: "I drink coffee with my colleague.", a: "Collaboration with colleagues enhances project output." },
                        { w: "Deadline", p: "/ËˆdedlaÉªn/", s: "I have a deadline tomorrow.", a: "Meeting regulatory deadlines is critical for compliance." },
                        { w: "Productivity", p: "/ËŒprÉ’dÊŒkËˆtÉªvÉ™ti/", s: "Reading books improves my productivity.", a: "We measure developer productivity through sprint velocity." },
                        { w: "Distraction", p: "/dÉªËˆstrÃ¦kÊƒn/", s: "Social media is a distraction.", a: "Minimizing workplace distractions boosts concentration." },
                        { w: "Environment", p: "/ÉªnËˆvaÉªrÉ™nmÉ™nt/", s: "I like a quiet study environment.", a: "A supportive environment fosters innovation." },
                        { w: "Flexible", p: "/ËˆfleksÉ™bl/", s: "My schedule is flexible.", a: "Flexible working arrangements attract top talent." },
                        { w: "Remote", p: "/rÉªËˆmÉ™ÊŠt/", s: "I am working remote today.", a: "Remote monitoring systems track server health." },
                        { w: "Session", p: "/ËˆseÊƒn/", s: "We have a study session.", a: "The elicitation session produced clear requirements." },
                        { w: "Balance", p: "/ËˆbÃ¦lÉ™ns/", s: "I need work-life balance.", a: "Balance sheets provide a snapshot of financial health." },
                        { w: "Improvement", p: "/ÉªmËˆpruËvmÉ™nt/", s: "I see some improvement.", a: "Continuous process improvement reduces waste." }
                    ],
                    specialized: [
                        { w: "Increment", p: "/ËˆÉªÅ‹krÉªmÉ™nt/", s: "Daily increment.", a: "The product increment must be potentially releasable." },
                        { w: "Sprint", p: "/sprÉªnt/", s: "A short sprint.", a: "A 2-week sprint is common in Scrum teams." },
                        { w: "Backlog", p: "/ËˆbÃ¦klÉ’É¡/", s: "Book backlog.", a: "The product backlog contains all desired features." },
                        { w: "Obstacle", p: "/ËˆÉ’bstÉ™kl/", s: "Road obstacle.", a: "We identify obstacles during the daily stand-up." },
                        { w: "Ticket", p: "/ËˆtÉªkÉªt/", s: "Movie ticket.", a: "Jira tickets track individual task progress." },
                        { w: "Status", p: "/ËˆsteÉªtÉ™s/", s: "Flight status.", a: "Reporting the current task status is mandatory." },
                        { w: "Sync", p: "/sÉªÅ‹k/", s: "Sync phone.", a: "The daily sync ensures team alignment." },
                        { w: "Progress", p: "/ËˆprÉ™ÊŠÉ¡res/", s: "Making progress.", a: "We track progress using a burndown chart." },
                        { w: "Delivery", p: "/dÉªËˆlÉªvÉ™ri/", s: "Fast delivery.", a: "Continuous delivery ensures frequent software releases." },
                        { w: "Update", p: "/ËŒÊŒpËˆdeÉªt/", s: "Profile update.", a: "Provide a brief update on your current activity." }
                    ],
                    fromListening: [
                        { w: "Recording", p: "/rÉªËˆkÉ”ËdÉªÅ‹/", context: "The team is recording a new podcast." },
                        { w: "Bothering", p: "/ËˆbÉ’Ã°É™rÉªÅ‹/", context: "I'm sorry for bothering you right now." },
                        { w: "Boss", p: "/bÉ’s/", context: "I need to report this to my boss." },
                        { w: "Co-worker", p: "/ËˆkÉ™ÊŠ wÉœËkÉ™/", context: "My co-worker is helping me with SQL." },
                        { w: "Task", p: "/tÉ‘Ësk/", context: "I have a difficult task to complete today." }
                    ]
                },
                4: {
                    type: "grammar",
                    title: "Grammar Focus: Present Continuous",
                    theory: "DÃ¹ng Ä‘á»ƒ diá»…n táº£ hÃ nh Ä‘á»™ng Ä‘ang xáº£y ra táº¡i thá»i Ä‘iá»ƒm nÃ³i hoáº·c cÃ¡c dá»± Ã¡n Ä‘ang thá»±c hiá»‡n trong giai Ä‘oáº¡n hiá»‡n táº¡i.",
                    formula: "S + am/is/are + V-ing",
                    examples: [
                        { context: "ğŸŒ± Daily", sentence: "I **am practicing** my pronunciation right now.", note: "Äang thá»±c hiá»‡n ngay lÃºc nÃ y." },
                        { context: "ğŸ“ MIS", sentence: "We **are building** a new dashboard for the team.", note: "Dá»± Ã¡n Ä‘ang trong quÃ¡ trÃ¬nh thá»±c hiá»‡n." }
                    ],
                    exercise: "DÃ¹ng Present Continuous Ä‘á»ƒ bÃ¡o cÃ¡o 3 task báº¡n Ä‘ang lÃ m trong buá»•i Stand-up sÃ¡ng nay."
                }
            },
            "p1-w3-d2": {
                summary: {
                    topic: "Office Life (IELTS) | Work Environment & Agile Tools (MIS)",
                    grammar: "Simple Present vs. Present Continuous (Contrast)",
                    pronunciation: "/k, É¡, f, v/ | Connected: Focus on, Look at",
                    listening: "BBC: Office Politics",
                    speaking: "Environment & Tools (4-Tier Focus)",
                    vocab: "25 words (Equipment, Coworker, Jira, Confluence...)"
                },
                0: {
                    type: "pronunciation",
                    title: "IPA Consonants 2: /k, É¡, f, v/",
                    dailyWords: [
                        { w: "Keep", p: "/kiËp/" }, { w: "Good", p: "/É¡ÊŠd/" }, { w: "Fine", p: "/faÉªn/" }, { w: "Very", p: "/Ëˆveri/" },
                        { w: "Back", p: "/bÃ¦k/" }, { w: "Bag", p: "/bÃ¦É¡/" }, { w: "Off", p: "/É’f/" }, { w: "Give", p: "/É¡Éªv/" }
                    ],
                    specializedWords: [
                        { w: "Key", p: "/kiË/" }, { w: "Goal", p: "/É¡É™ÊŠl/" }, { w: "Feature", p: "/ËˆfiËtÊƒÉ™/" }, { w: "Value", p: "/ËˆvÃ¦ljuË/" },
                        { w: "Click", p: "/klÉªk/" }, { w: "Group", p: "/É¡ruËp/" }, { w: "Fill", p: "/fÉªl/" }, { w: "View", p: "/vjuË/" }
                    ],
                    connectedSpeech: [
                        { text: "Focus on", linking: "/ËˆfÉ™ÊŠkÉ™sÉ’n/", type: "Ná»‘i Ã¢m" },
                        { text: "Look at", linking: "/lÊŠkÃ¦t/", type: "Ná»‘i Ã¢m" },
                        { text: "Work office", linking: "/wÉœËkËˆÉ’fÉªs/", type: "Ná»‘i Ã¢m" }
                    ],
                    steps: [{ num: 1, text: "Luyá»‡n Ã¢m /k/ vÃ  /f/ (vÃ´ thanh) vs /É¡/ vÃ  /v/ (há»¯u thanh)." }]
                },
                1: {
                    type: "listening",
                    title: "BBC: Office Politics",
                    steps: [
                        { num: 1, text: "BBC 6 Minute English: Office Politics (BBC):", link: "https://www.bbc.co.uk/learningenglish/english/features/6-minute-english/ep-190516" },
                        { num: 2, text: "Dá»± phÃ²ng (YouTube):", link: "https://www.youtube.com/watch?v=R9_mQ_Q5qN0" },
                        { num: 3, text: "Note 3 khÃ¡i niá»‡m chÃ­nh vá» quan há»‡ cÃ´ng sá»Ÿ." }
                    ]
                },
                2: {
                    type: "speaking", title: "Office Environment (4-Tier Focus)",
                    scenarios: [
                        {
                            title: "ğŸŒ± Daily Context: Work Environment",
                            questions: ["Do you like your office?", "What's the best thing about your workplace?"],
                            samples: `**Opinion:** I really enjoy the open-plan layout of my office.
**Reason:** It fosters better communication and makes everyone feel more accessible.
**Example:** For instance, I can easily chat with my colleagues without having to book a meeting room.
**Therefore:** This setup creates a very collaborative and friendly atmosphere.`
                        },
                        {
                            title: "ğŸ“ Professional Context: Management Tools",
                            questions: ["Which tools do you use to manage tasks?", "How do they help your team?"],
                            samples: `**Opinion:** We primarily use Jira and Confluence for our project management.
**Reason:** These tools provide a centralized platform for tracking progress and documenting requirements.
**Example:** For example, we create Jira tickets for every feature and use Confluence to store our SRS.
**Therefore:** It ensures transparency and helps the team stay aligned with the project goals.`
                        }
                    ]
                },
                3: {
                    type: "vocabulary", title: "Office & Collaboration (25 words)",
                    core: [
                        { w: "Equipment", p: "/ÉªËˆkwÉªpmÉ™nt/", s: "New office equipment.", a: "Upgrading server equipment improves reliability." },
                        { w: "Cubicle", p: "/ËˆkjuËbÉªkl/", s: "My cozy cubicle.", a: "Modern offices are replacing cubicles with open spaces." },
                        { w: "Colleague", p: "/ËˆkÉ’liËÉ¡/", s: "Helpful colleague.", a: "Effective communication between colleagues is vital." },
                        { w: "Meeting", p: "/ËˆmiËtÉªÅ‹/", s: "Ten o'clock meeting.", a: "The stakeholder meeting clarified the project scope." },
                        { w: "Schedule", p: "/ËˆÊƒedjuËl/", s: "Busy schedule.", a: "The project schedule includes buffer time for risks." },
                        { w: "Supplies", p: "/sÉ™ËˆplaÉªz/", s: "Stationery supplies.", a: "Cloud computing reduces the need for physical IT supplies." },
                        { w: "Salary", p: "/ËˆsÃ¦lÉ™ri/", s: "Monthly salary.", a: "BAs evaluate the ROI of a salary automation system." },
                        { w: "Manager", p: "/ËˆmÃ¦nÉªdÊ’É™/", s: "Office manager.", a: "The product manager prioritizes the backlog." },
                        { w: "Employee", p: "/ÉªmËˆplÉ”ÉªiË/", s: "New employee.", a: "Employee engagement is key to low turnover rates." },
                        { w: "Kitchen", p: "/ËˆkÉªtÊƒÉªn/", s: "The office kitchen.", a: "Casual talks in the office kitchen often lead to breakthroughs." }
                    ],
                    specialized: [
                        { w: "Dashboard", p: "/ËˆdÃ¦ÊƒbÉ”Ëd/", s: "Check the dashboard.", a: "The executive dashboard shows real-time KPIs." },
                        { w: "Ecosystem", p: "/ËˆiËkÉ™ÊŠsÉªstÉ™m/", s: "Tech ecosystem.", a: "Our software is part of a larger enterprise ecosystem." },
                        { w: "Workflow", p: "/ËˆwÉœËkflÉ™ÊŠ/", s: "Efficient workflow.", a: "Automation optimizes the approval workflow." },
                        { w: "Interface", p: "/ËˆÉªntÉ™feÉªs/", s: "User interface.", a: "The UI must be intuitive for end-users." },
                        { w: "Platform", p: "/ËˆplÃ¦tfÉ”Ërm/", s: "Cloud platform.", a: "Platform as a Service (PaaS) simplifies deployment." },
                        { w: "Portal", p: "/ËˆpÉ”Ërtl/", s: "Employee portal.", a: "The client portal allows secure access to accounts." },
                        { w: "Toolkit", p: "/ËˆtuËlkÉªt/", s: "Digital toolkit.", a: "The analyst's toolkit includes SQL and Python." },
                        { w: "Virtual", p: "/ËˆvÉœËrtÊƒuÉ™l/", s: "Virtual meeting.", a: "Virtual machines (VMs) allow multiple OS on one hardware." },
                        { w: "Automation", p: "/ËŒÉ”ËtÉ™ËˆmeÉªÊƒn/", s: "Office automation.", a: "RPA tools handle repetitive data entry tasks." },
                        { w: "Collaboration", p: "/kÉ™ËŒlÃ¦bÉ™ËˆreÉªÊƒn/", s: "Team collaboration.", a: "Cross-functional collaboration is the heart of Agile." }
                    ],
                    fromListening: [
                        { w: "Politics", p: "/ËˆpÉ’lÉ™tÉªks/", context: "Navigating office politics is a skill." },
                        { w: "Promotion", p: "/prÉ™ËˆmÉ™ÊŠÊƒn/", context: "He deserves a promotion for his hard work." },
                        { w: "Feedback", p: "/ËˆfiËdbÃ¦k/", context: "Constructive feedback helps us grow." },
                        { w: "Gossip", p: "/ËˆÉ¡É’sÉªp/", context: "Avoid office gossip to stay professional." },
                        { w: "Network", p: "/ËˆnetwÉœËk/", context: "It's important to network with other BAs." }
                    ]
                },
                4: {
                    type: "grammar",
                    title: "Grammar Focus: Simple Present vs. Present Continuous",
                    theory: "Sá»­ dá»¥ng Simple Present cho cÃ¡c thÃ³i quen/quy táº¯c cá»‘ Ä‘á»‹nh. Sá»­ dá»¥ng Present Continuous cho cÃ¡c hÃ nh Ä‘á»™ng Ä‘ang diá»…n ra hoáº·c dá»± Ã¡n táº¡m thá»i.",
                    formula: "Simple: S + V(s/es) | Continuous: S + am/is/are + V-ing",
                    examples: [
                        { context: "ğŸŒ± Daily", sentence: "I **usually work** at the office, but today I **am working** from home.", note: "ThÃ³i quen vs. HÃ nh Ä‘á»™ng táº¡m thá»i." },
                        { context: "ğŸ“ MIS", sentence: "The system **processes** data daily, and it **is currently running** a backup.", note: "Chá»©c nÄƒng cá»‘ Ä‘á»‹nh vs. Tráº¡ng thÃ¡i hiá»‡n táº¡i." }
                    ],
                    exercise: "Viáº¿t 2 cÃ¢u so sÃ¡nh nhá»¯ng gÃ¬ báº¡n THÆ¯á»œNG LÃ€M vÃ  nhá»¯ng gÃ¬ báº¡n ÄANG LÃ€M ngay lÃºc nÃ y táº¡i vÄƒn phÃ²ng."
                }
            },
            "p1-w2-d7": {
                summary: {
                    topic: "Achievement Checkpoint 2 | Feedback Session",
                    pronunciation: "Record 2-min self-intro",
                    listening: "Free listening: YouTube Tech News",
                    speaking: "Peer review or Self-assessment",
                    vocab: "15-day Progress Review"
                },
                0: { type: "pronunciation", title: "Self-Intro Recording", steps: [{ num: 1, text: "Record intro including job and house." }] },
                1: { type: "listening", title: "Free Tech Choice", steps: [{ num: 1, text: "Watch MKBHD or TechCrunch." }] },
                2: { type: "speaking", title: "Reflection", scenarios: [{ title: "Review", questions: ["What was hard this week?"], samples: "Pronunciation of /eÉ™/ /ÊŠÉ™/." }] },
                3: { type: "vocabulary", title: "Audit", core: [{ w: "Mastery", p: "/ËˆmÉ‘ËstÉ™ri/", s: "Keep going!", a: "Track your milestones." }] }
            }
        };

        // Session State
        let currentSession = null;

        function startFlashcardSession(dayId, idx, source = 'words') {
            const curriculum = lessonCurriculum[dayId]?.[idx];
            if (!curriculum) return;

            let items = [];
            if (source === 'words') {
                // Support both pronunciation (dailyWords) and vocabulary (core) task formats
                const words1 = curriculum.dailyWords || curriculum.core || [];
                const words2 = curriculum.specializedWords || curriculum.specialized || [];
                const words3 = curriculum.fromListening || [];
                items = [...words1, ...words2, ...words3];
            } else {
                items = curriculum.connectedSpeech || [];
            }

            if (items.length === 0) {
                alert("KhÃ´ng cÃ³ ná»™i dung cho pháº§n nÃ y!");
                return;
            }

            currentSession = {
                dayId,
                idx,
                items: items,
                items: items,
                currentIndex: 0,
                isFlipped: false,
                sessionType: source,
                phase: 'flashcard'
            };

            refreshModalContent(dayId, idx);
        }

        function nextFlashcard() {
            if (!currentSession) return;
            if (currentSession.currentIndex < currentSession.items.length - 1) {
                currentSession.currentIndex++;
                currentSession.isFlipped = false;
                audioUrl = null;
                renderFlashcardUI();
            } else {
                finishFlashcardSession();
            }
        }

        function prevFlashcard() {
            if (!currentSession || currentSession.currentIndex === 0) return;
            currentSession.currentIndex--;
            currentSession.isFlipped = false;
            audioUrl = null;
            renderFlashcardUI();
        }

        function flipFlashcard() {
            if (!currentSession) return;
            currentSession.isFlipped = !currentSession.isFlipped;
            const card = document.querySelector('.flashcard');
            if (card) {
                card.classList.toggle('flipped', currentSession.isFlipped);
            }
        }

        function finishFlashcardSession() {
            const dayId = document.getElementById('session-day-id').value;
            const idx = parseInt(document.getElementById('session-task-idx').value);
            const curriculum = lessonCurriculum[dayId]?.[idx];

            if (currentSession && currentSession.sessionType === 'words' && curriculum) {
                // Chaining for Pronunciation: Words -> Speech
                if (curriculum.type === 'pronunciation' && curriculum.connectedSpeech && curriculum.connectedSpeech.length > 0) {
                    currentSession = null;
                    startFlashcardSession(dayId, idx, 'speech');
                    return;
                }

                // Chaining for Vocabulary: Flashcard -> Spelling -> Mastery
                if (curriculum.type === 'vocabulary') {
                    if (!currentSession.phase || currentSession.phase === 'flashcard') {
                        currentSession.phase = 'spelling';
                        renderFlashcardUI();
                        return;
                    }
                    if (currentSession.phase === 'spelling') {
                        currentSession.phase = 'mastery';
                        renderFlashcardUI();
                        return;
                    }
                }
            }

            currentSession = null;
            refreshModalContent(dayId, idx);
        }

        function refreshModalContent(dayId, idx) {
            const curriculum = lessonCurriculum[dayId]?.[idx] || { type: 'default', steps: [] };
            const detail = userData[dayId].details[idx];
            const contentArea = document.getElementById('modal-dynamic-content');
            if (contentArea) {
                contentArea.innerHTML = renderCurriculumContent(curriculum, detail, dayId, idx);
                if (currentSession) renderFlashcardUI();
            }
        }

        function renderFlashcardUI() {
            if (!currentSession) return;
            const item = currentSession.items[currentSession.currentIndex];
            const progress = ((currentSession.currentIndex + 1) / currentSession.items.length) * 100;

            const container = document.getElementById('session-flashcard-container');
            if (!container) return;

            // --- PHASE: SPELLING CHALLENGE ---
            if (currentSession.phase === 'spelling') {
                container.innerHTML = `
                    <div style="background:var(--card-bg); border-radius:12px; padding:2rem; border:1px solid var(--glass-border); text-align:center; height:100%; display:flex; flex-direction:column; justify-content:center">
                        <h3 style="color:var(--accent); margin-bottom:1.5rem">âœï¸ Spelling Challenge</h3>
                        <p style="color:var(--text-muted); font-size:0.9rem; margin-bottom:2rem">NhÃ¬n phiÃªn Ã¢m, Ä‘iá»n tá»« vá»±ng Ä‘Ãºng Ä‘á»ƒ qua mÃ n!</p>
                        
                        <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap:15px; overflow-y:auto; max-height:400px; padding:5px">
                            ${currentSession.items.slice(0, 8).map((item, i) => `
                                <div style="background:rgba(255,255,255,0.03); padding:12px; border-radius:8px; display:flex; flex-direction:column; align-items:center; gap:8px">
                                    <span class="ipa-text" style="font-size:0.9rem;">${item.p}</span>
                                    <input type="text" placeholder="Go..." style="width:100%; background:rgba(0,0,0,0.2); border:1px solid var(--glass-border); color:white; padding:8px; border-radius:4px; text-align:center; outline:none" onkeyup="if(this.value.toLowerCase() === '${item.w.toLowerCase()}') this.style.borderColor = '#10b981'">
                                </div>
                            `).join('')}
                        </div>

                        <div style="margin-top:2rem">
                             <button class="session-btn next" style="width:100%" onclick="finishFlashcardSession()">HoÃ n thÃ nh & Tiáº¿p tá»¥c ğŸ§ </button>
                        </div>
                    </div>
                `;
                return;
            }

            // --- PHASE: SENTENCE MASTERY ---
            if (currentSession.phase === 'mastery') {
                const detail = userData[currentSession.dayId].details[currentSession.idx];
                container.innerHTML = `
                    <div style="background:var(--card-bg); border-radius:12px; padding:2rem; border:1px solid var(--glass-border); height:100%; display:flex; flex-direction:column;">
                        <h3 style="color:#10b981; margin-bottom:1rem; text-align:center">ğŸ§  Sentence Mastery (Context)</h3>
                        <p style="color:var(--text-muted); font-size:0.85rem; text-align:center; margin-bottom:1.5rem">Chá»n tá»« vÃ  Ä‘áº·t cÃ¢u (Simple & Academic) Ä‘á»ƒ hoÃ n thÃ nh bÃ i há»c.</p>
                        
                        <div style="flex:1; overflow-y:auto; padding-right:5px">
                            <div style="margin-bottom:1rem; display:flex; flex-wrap:wrap; gap:6px; justify-content:center">
                                ${currentSession.items.map(item => `
                                    <span class="word-pill" style="font-size:0.8rem; padding:4px 10px" onclick="insertWord('${item.w}')">${item.w}</span>
                                `).join('')}
                            </div>
                            
                            <div style="display:grid; grid-template-columns: 1fr; gap:15px; margin-bottom:1.5rem">
                                <div>
                                    <div style="font-size:0.75rem; color:#10b981; margin-bottom:5px">ğŸŒ± CÃ¢u Ä‘Æ¡n giáº£n (Daily):</div>
                                    <div class="sentence-editor" id="vocab-editor-simple" contenteditable="true" placeholder="..." style="min-height:60px; font-size:0.85rem; padding:10px"></div>
                                </div>
                                <div>
                                    <div style="font-size:0.75rem; color:var(--accent); margin-bottom:5px">ğŸ“ CÃ¢u há»c thuáº­t (Academic):</div>
                                    <div class="sentence-editor" id="vocab-editor" contenteditable="true" placeholder="..." style="min-height:60px; font-size:0.85rem; padding:10px">${detail.editorContent || ''}</div>
                                </div>
                            </div>

                             <!-- Grammar Feedback Box -->
                            <div id="grammar-box" class="grammar-feedback">
                                <span class="feedback-title" id="grammar-title">AI Feedback</span>
                                <div class="feedback-reason" id="grammar-reason"></div>
                            </div>
                        </div>

                        <div style="margin-top:1rem; display:flex; gap:10px">
                             <button class="studio-btn play" style="flex:1; justify-content:center" onclick="checkSentenceGrammar('${currentSession.dayId}', ${currentSession.idx})">ğŸ” AI Check</button>
                             <button class="session-btn next" style="flex:1" onclick="finishFlashcardSession()">Tá»•ng káº¿t bÃ i há»c ğŸ‰</button>
                        </div>
                    </div>
                `;
                return;
            }

            const isSpeech = currentSession.sessionType === 'speech';

            container.innerHTML = `
                <div class="session-progress">
                    <div class="session-progress-bar" style="width: ${progress}%"></div>
                </div>
                <div style="display:flex; justify-content:space-between; width:100%; align-items:center; margin-top:5px">
                    <p style="font-size: 0.75rem; color: var(--text-muted);">${isSpeech ? 'âš¡ Connected Speech Mode' : 'ğŸ´ Vocabulary Mode'}</p>
                    <div style="display:flex; align-items:center; gap:10px">
                        <button onclick="finishFlashcardSession()" style="background:none; border:none; color:var(--primary-light); font-size:0.75rem; cursor:pointer; text-decoration:underline">Xem toÃ n bá»™ bÃ i</button>
                        <p style="font-size: 0.8rem; color: var(--text-muted);">${currentSession.currentIndex + 1} / ${currentSession.items.length}</p>
                    </div>
                </div>
                
                <div class="flashcard-wrapper" onclick="flipFlashcard()">
                    <div class="flashcard ${currentSession.isFlipped ? 'flipped' : ''}">
                        <!-- FRONT: Word + Pronunciation + Recording -->
                        <div class="flashcard-face flashcard-front">
                            <div style="font-size: 0.7rem; text-transform:uppercase; letter-spacing:1px; margin-bottom:1rem; opacity:0.6">${isSpeech ? item.type : 'Vocabulary'}</div>
                            <h3 style="font-size: ${isSpeech ? '2.2rem' : '3rem'}; margin-bottom: 2rem">${isSpeech ? item.text : item.w}</h3>
                            
                            <div style="display:flex; flex-direction:column; gap:15px; width:100%; align-items:center" onclick="event.stopPropagation()">
                                <div style="display:flex; gap:12px">
                                    <button class="studio-btn play" style="padding: 10px 25px; min-width:140px; justify-content:center" onclick="speakPhrase('${isSpeech ? item.text : item.w}')">
                                        <span>ğŸ”Š</span> Nghe máº«u
                                    </button>
                                    ${isSpeech ? `
                                        <button class="studio-btn play" style="padding: 10px 25px; min-width:140px; justify-content:center; background:var(--primary); border:none" onclick="speakPhrase('${item.text}', false)">
                                            <span>âš¡</span> Nghe Native
                                        </button>
                                    ` : ''}
                                </div>
                                
                                <div style="background:rgba(255,255,255,0.05); padding:12px; border-radius:12px; width:80%; border:1px solid rgba(255,255,255,0.1)">
                                    <p style="font-size: 0.75rem; margin-bottom:8px; color:var(--text-muted)">ğŸ™ï¸ Luyá»‡n Ä‘á»c & Ghi Ã¢m</p>
                                    <div style="display:flex; justify-content:center; gap:10px">
                                        <button class="record-btn" id="fc-record-btn" onclick="toggleRecording('flashcard')" style="width:40px; height:40px; border-radius:50%; background:white; color:#ef4444; border:none; cursor:pointer; font-weight:bold">â—</button>
                                        <button class="play-btn hidden" id="fc-playback-btn" onclick="playRecording()" style="padding:0 15px; border-radius:20px; background:var(--primary); color:white; border:none; cursor:pointer; font-size:0.8rem">â–¶ Nghe láº¡i</button>
                                    </div>
                                    <div id="fc-status" style="margin-top: 5px; font-size: 0.65rem; color: var(--text-muted);">Sáºµn sÃ ng ghi Ã¢m</div>
                                </div>
                            </div>
                            
                            <p style="margin-top:2rem; font-size:0.8rem; color:var(--text-muted)">Nháº¥p vÃ¹ng trá»‘ng Ä‘á»ƒ láº­t máº·t sau â†—</p>
                        </div>
                        
                        <!-- BACK: IPA + Details -->
                        <div class="flashcard-face flashcard-back">
                            ${isSpeech ? `
                                <div class="speech-ipa" style="width:100%; margin-bottom:1.5rem">${item.linking}</div>
                                <div style="text-align:left; width:100%">
                                    <div style="margin-bottom:1.2rem">
                                        <label style="font-size:0.65rem; color:var(--text-muted); text-transform:uppercase; letter-spacing:1px; display:block; margin-bottom:4px">ğŸ’¡ Ghi chÃº ná»‘i Ã¢m</label>
                                        <p style="font-size:1rem; color:var(--text-main); line-height:1.5">${item.note}</p>
                                    </div>
                                </div>
                            ` : `
                                <div style="width:100%; text-align:left; overflow-y:auto; max-height:100%; padding-right:5px">
                                    <div class="speech-ipa" style="margin-bottom:1.2rem; display:inline-block; width:auto; padding:5px 15px">
                                        ${item.p}
                                        <a href="https://dictionary.cambridge.org/vi/dictionary/english/${item.w.toLowerCase()}" target="_blank" onclick="event.stopPropagation()" style="text-decoration:none; margin-left:10px">
                                            <span style="background:#112e51; color:white; font-size:0.6rem; padding:2px 6px; border-radius:4px; font-weight:800; vertical-align:middle">CAMBRIDGE â†—</span>
                                        </a>
                                    </div>
                                    
                                    <div style="margin-bottom:1.2rem">
                                        <label style="font-size:0.65rem; color:var(--text-muted); text-transform:uppercase; letter-spacing:1px; display:block; margin-bottom:4px">ğŸ”‘ Äá»‹nh nghÄ©a</label>
                                        <p style="font-size:1.1rem; color:var(--accent); font-weight:700;">${item.m || item.meaning || "Nháº¥p Ä‘á»ƒ xem nghÄ©a"}</p>
                                    </div>

                                    <div style="margin-bottom:1.2rem">
                                        <label style="font-size:0.65rem; color:var(--text-muted); text-transform:uppercase; letter-spacing:1px; display:block; margin-bottom:4px">ğŸ“ VÃ­ dá»¥ cÆ¡ báº£n</label>
                                        <p style="font-size:0.85rem; color:var(--text-main); line-height:1.5; font-style:italic; opacity:0.9">"${item.e || item.s || item.context || "ChÆ°a cÃ³ vÃ­ dá»¥."}"</p>
                                    </div>

                                    ${(item.adv || item.a) ? `
                                        <div style="margin-bottom:1.5rem; background:rgba(99, 102, 241, 0.08); padding:12px; border-radius:10px; border-left:4px solid var(--primary)">
                                            <label style="font-size:0.65rem; color:var(--primary-light); text-transform:uppercase; letter-spacing:1px; display:block; margin-bottom:4px">ğŸ† Cáº¥p Ä‘á»™ 7.0+ (Advanced)</label>
                                            <p style="font-size:0.85rem; color:var(--text-main); line-height:1.5">${item.adv || item.a}</p>
                                        </div>
                                    ` : ''}
                                </div>
                            `}
                        </div>
                    </div>
                </div>

                <div class="session-controls" style="margin-top:20px">
                    <button class="session-btn" onclick="prevFlashcard()" ${currentSession.currentIndex === 0 ? 'disabled style="opacity:0.3"' : ''}>TrÆ°á»›c</button>
                    <button class="session-btn next" onclick="nextFlashcard()">
                        ${(() => {
                    if (currentSession.currentIndex < currentSession.items.length - 1) return 'Tiáº¿p theo';
                    const curriculum = lessonCurriculum[currentSession.dayId]?.[currentSession.idx];

                    // Pronunciation Chain
                    if (currentSession.sessionType === 'words' && curriculum.type === 'pronunciation' && curriculum.connectedSpeech && curriculum.connectedSpeech.length > 0) {
                        return 'Luyá»‡n Ná»‘i Ã¢m â†’';
                    }

                    // Vocabulary Chain
                    if (curriculum.type === 'vocabulary') {
                        if (currentSession.phase === 'flashcard') return 'Tiáº¿p: Spelling Check âœï¸';
                        if (currentSession.phase === 'spelling') return 'Tiáº¿p: Sentence Mastery ğŸ§ ';
                    }

                    return 'HoÃ n thÃ nh';
                })()}
                    </button>
                </div>
            `;
        }

        const phase1Requirements = {
            0: { time: "30 phÃºt", output: "PhÃ¡t Ã¢m chuáº©n IPA, quay/ghi Ã¢m shadowing" },
            1: { time: "40 phÃºt", output: "Note 5 tá»« má»›i, tÃ³m táº¯t Ä‘Æ°á»£c Ã½ chÃ­nh audio" },
            2: { time: "30 phÃºt", output: "File thu Ã¢m 1-2 phÃºt theo khung template" },
            3: { time: "30-40 phÃºt", output: "10 tá»« Core + 5 tá»« MIS (Anki/Notion)" },
            4: { time: "20 phÃºt", output: "Hiá»ƒu cÃ´ng thá»©c, viáº¿t Ä‘Æ°á»£c 3-5 cÃ¢u á»©ng dá»¥ng" }
        };

        function openTaskForm(dayId, idx, taskName) {
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';

            if (!userData[dayId]) userData[dayId] = { tasks: [], notes: [], details: {} };
            if (!userData[dayId].details) userData[dayId].details = {};

            const stageNum = parseInt(dayId.split('-')[0].replace('p', ''));
            let planReq = { time: "60 phÃºt", output: "HoÃ n thÃ nh cÃ¡c Ä‘áº§u viá»‡c trong giÃ¡o Ã¡n" };
            if (stageNum === 1) planReq = phase1Requirements[idx] || planReq;

            if (!userData[dayId].details[idx]) {
                userData[dayId].details[idx] = { note: '', sessions: 0 };
            }

            const detail = userData[dayId].details[idx];
            const curriculum = lessonCurriculum[dayId]?.[idx] || { type: 'default', steps: [] };

            // FLASHCARD-FIRST FLOW: Auto-start session for Pronunciation & Vocab
            if (!currentSession && (curriculum.type === 'pronunciation' || curriculum.type === 'vocabulary')) {
                let items = [];
                if (curriculum.type === 'pronunciation') {
                    const words1 = curriculum.dailyWords || [];
                    const words2 = curriculum.specializedWords || [];
                    items = [...words1, ...words2];
                } else if (curriculum.type === 'vocabulary') {
                    const words1 = curriculum.core || [];
                    const words2 = curriculum.specialized || [];
                    const words3 = curriculum.fromListening || [];
                    items = [...words1, ...words2, ...words3];
                }

                if (items.length > 0) {
                    currentSession = {
                        dayId,
                        idx,
                        items: items,
                        currentIndex: 0,
                        isFlipped: false,
                        sessionType: 'words',
                        phase: 'flashcard'
                    };
                }
            }

            modal.innerHTML = `
                <div class="modal-content" style="max-height: 90vh; overflow-y: auto;">
                    <span class="close-x" onclick="closeModal()">Ã—</span>
                    <input type="hidden" id="session-day-id" value="${dayId}">
                    <input type="hidden" id="session-task-idx" value="${idx}">
                    
                    <div class="modal-header">
                        <h2>${curriculum.title || taskName}</h2>
                        <div style="font-size: 0.85rem; color: var(--text-muted);">ğŸ“Š Tá»•ng sá»‘ láº§n há»c: <span style="color: var(--accent); font-weight: 800;">${detail.sessions || 0}</span></div>
                    </div>

                    <div id="modal-dynamic-content">
                        ${renderCurriculumContent(curriculum, detail, dayId, idx)}
                    </div>

                    <div class="form-group" style="margin-top:2rem">
                        <label>Ghi chÃº cho phiÃªn há»c nÃ y</label>
                        <textarea id="modal-note" placeholder="Nháº­p káº¿t quáº£, tá»« vá»±ng má»›i hoáº·c khÃ³ khÄƒn cá»§a báº¡n...">${detail.note || ''}</textarea>
                    </div>

                    <div class="modal-actions">
                        <button class="btn btn-close" onclick="closeModal()">ÄÃ³ng</button>
                        <button class="btn btn-primary" onclick="finishTask('${dayId}', ${idx})">LÆ°u & HoÃ n thÃ nh</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            // AUTO-RENDER: If we have an active session, render it immediately
            if (currentSession) {
                renderFlashcardUI();
            }
        }


        function renderCurriculumContent(c, detail, dayId, idx) {
            if (c.type === 'pronunciation') {
                if (currentSession) {
                    return `<div id="session-flashcard-container" class="session-container"></div>`;
                }

                return `
                    <!-- 1. Learning Steps & Warm-up -->
                    <div class="steps-flow" style="margin-bottom: 2rem;">
                        ${c.steps.map(s => `
                            <div class="flow-item">
                                <div class="flow-dot"></div>
                                <div class="flow-info">
                                    <div class="flow-text">${s.text}</div>
                                    ${s.link ? `<a href="${s.link}" target="_blank" class="mini-link">Xem Video / TÃ i liá»‡u hÆ°á»›ng dáº«n â†’</a>` : ''}
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <!-- 2. Shadowing Studio (Focused Practice) -->
                    <div class="shadowing-podium" style="margin-bottom: 2rem;">
                        <h4>ğŸ™ï¸ Shadowing Studio</h4>
                        <div class="studio-controls">
                            <button class="studio-btn record" id="pron-rec" onclick="toggleRecording('pronunciation')">
                                <span>â—</span> Báº¯t Ä‘áº§u Shadowing
                            </button>
                            <button class="studio-btn play hidden" id="pron-playback" onclick="playRecording()">
                                <span>â–¶</span> Nghe láº¡i & So sÃ¡nh
                            </button>
                        </div>
                        <div id="listen-status" class="studio-status">Sáºµn sÃ ng luyá»‡n Shadowing cÃ¡c cá»¥m trong bÃ i</div>
                    </div>

                    <hr style="border:none; border-top:1px solid var(--glass-border); margin: 2rem 0; opacity: 0.3;">

                    <!-- 3. Vocabulary & Mastery Lab -->
                    <div class="vocab-lab">
                        <h4 style="color:var(--text-muted); font-size:0.8rem; text-transform:uppercase; margin-bottom:1.5rem; text-align:center; letter-spacing:1px">ğŸ› ï¸ Mastery Lab (Vocabulary & Linking)</h4>
                        
                        <div style="display:flex; gap:12px; justify-content:center; margin-bottom: 2rem; flex-wrap:wrap">
                            <button class="btn btn-primary" style="padding: 0.8rem 1.5rem;" onclick="startFlashcardSession('${dayId}', ${idx}, 'words')">ğŸ´ Há»c Tá»« vá»±ng (Flashcards)</button>
                            <button class="btn" style="padding: 0.8rem 1.5rem; background:rgba(16, 185, 129, 0.1); border:1px solid #10b981; color:#10b981" onclick="startFlashcardSession('${dayId}', ${idx}, 'speech')">âš¡ Há»c Ná»‘i Ã¢m (Flashcards)</button>
                        </div>

                        <!-- 1. Vocabulary Grid (Detailed List) -->
                        <div style="margin-bottom: 2.5rem;">
                            <div style="display:flex; align-items:center; gap:10px; margin-bottom:1rem">
                                <span style="background:var(--primary); width:3px; height:15px; border-radius:2px;"></span>
                                <label style="font-weight:700; color:white; font-size:0.9rem">1. Detailed Pronunciation List (Focus Sound)</label>
                            </div>
                            
                            <div style="display:grid; grid-template-columns: 1fr; gap:12px">
                                ${[...(c.dailyWords || []), ...(c.specializedWords || [])].map(i => `
                                    <div class="vocab-item" style="background:rgba(255,255,255,0.03); padding:16px; border-radius:12px; display:flex; flex-direction:column; gap:8px; border:1px solid rgba(255,255,255,0.05); position:relative; overflow:hidden; transition: all 0.3s ease">
                                        <div style="display:flex; justify-content:space-between; align-items:center">
                                            <div>
                                                <strong style="color:var(--text-main); font-size:1.1rem">${i.w}</strong> 
                                                <span class="ipa-text" style="font-size:0.85rem; color:var(--accent); display:inline; margin-left:8px">${i.p}</span>
                                            </div>
                                            <div style="display:flex; gap:8px">
                                                <button class="mini-btn" onclick="speakPhrase('${i.w}')" title="Nghe phÃ¡t Ã¢m">ğŸ”Š</button>
                                                <a href="https://dictionary.cambridge.org/vi/dictionary/english/${i.w.toLowerCase()}" target="_blank" class="cambridge-badge" style="text-decoration:none" title="Xem táº¡i Cambridge Dictionary">
                                                    <span style="background:#112e51; color:white; font-size:0.6rem; padding:2px 6px; border-radius:4px; font-weight:800">CAMBRIDGE</span>
                                                </a>
                                            </div>
                                        </div>
                                        ${i.m ? `<div style="font-size:0.92rem; color:var(--accent); font-weight:700; margin-bottom:4px; font-style: italic; line-height:1.3">${i.m}</div>` : ''}
                                        ${i.s ? `
                                        <div style="font-size:0.88rem; color:var(--text-muted); line-height:1.4; border-left:3px solid #10b981; padding-left:10px; background: rgba(16, 185, 129, 0.05); padding-top: 5px; padding-bottom: 5px;">
                                            <span style="font-size:0.7rem; color:#10b981; font-weight:800; display:block; margin-bottom:2px">PRACTICAL EXAMPLE (DAILY)</span>
                                            ${i.s}
                                        </div>` : ''}
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <!-- 2. Connected Speech -->
                            <h4 style="color:var(--accent); margin-bottom:1rem; display:flex; align-items:center; gap:8px">
                                <span style="background:var(--primary); width:4px; height:18px; border-radius:2px;"></span>
                                2. Connected Speech (Ná»‘i & Nuá»‘t Ã¢m)
                            </h4>
                            <div class="speech-grid">
                                ${(c.connectedSpeech || [
                        { text: "Wake up", linking: "/weÉª kÊŒp/", type: "Ná»‘i Ã¢m", note: "Phá»¥ Ã¢m /k/ ná»‘i vá»›i nguyÃªn Ã¢m /ÊŒ/" },
                        { text: "Check it out", linking: "/tÊƒekÉªtaÊŠt/", type: "Ná»‘i Ã¢m", note: "Ná»‘i liÃªn hoÃ n cÃ¡c Ã¢m cuá»‘i" },
                        { text: "Next day", linking: "/neks deÉª/", type: "Nuá»‘t Ã¢m", note: "Ã‚m /t/ bá»‹ nuá»‘t vÃ¬ Ä‘á»©ng giá»¯a 2 phá»¥ Ã¢m" }
                    ]).map(item => `
                                    <div class="speech-card ${item.type === 'Nuá»‘t Ã¢m' ? 'elision' : ''}">
                                        <div class="speech-header">
                                            <div class="speech-title">${item.text}</div>
                                            <div class="speech-type">${item.type}</div>
                                        </div>
                                        <div class="speech-comparison">
                                            <div class="compare-box">
                                                <span class="compare-label">ğŸ¤– Robot</span>
                                                <button class="compare-btn" onclick="speakPhrase('${item.text}', true)"><span>â–¶</span> Nghe</button>
                                            </div>
                                            <div style="color:var(--glass-border); font-size:1.2rem">VS</div>
                                            <div class="compare-box">
                                                <span class="compare-label">âš¡ Native</span>
                                                <button class="compare-btn" style="background:var(--primary); border:none" onclick="speakPhrase('${item.text}', false)"><span>â–¶</span> Nghe</button>
                                            </div>
                                        </div>
                                        <div class="speech-ipa">${item.linking}</div>
                                        <div class="speech-note"><span><strong>ğŸ’¡</strong> ${item.note}</span></div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            }

            if (c.type === 'listening') {
                return `
                    <div class="recorder-zone">
                        <p>ğŸ™ï¸ Listen & Record your Shadowing</p>
                        <div class="recorder-btns">
                            <button class="record-btn" id="listen-rec" onclick="toggleRecording('listening')">â—</button>
                            <button class="play-btn hidden" id="listen-playback" onclick="playRecording()">â–¶ Nghe láº¡i (Playback)</button>
                        </div>
                        <div id="listen-status" style="margin-top:10px; font-size:0.8rem">Sáºµn sÃ ng ghi Ã¢m</div>
                        <div class="accuracy-badge accuracy-high hidden" id="listen-acc">Äá»™ chÃ­nh xÃ¡c: 85%</div>
                    </div>
                    ${renderSteps(c.steps)}
                `;
            }

            if (c.type === 'speaking') {
                return `
                    <div class="lesson-card">
                        ${c.scenarios.map(s => `
                            <div style="margin-bottom:1.5rem">
                                <h4 style="color:var(--accent); margin-bottom:0.5rem">ğŸ“ ${s.title}</h4>
                                <div style="background:rgba(255,255,255,0.03); padding:1rem; border-radius:0.5rem; margin-bottom:0.8rem">
                                    <p style="font-size:0.8rem; color:var(--text-muted); margin-bottom:0.5rem">CÃ¢u há»i gá»£i Ã½:</p>
                                    <ul style="font-size:0.9rem; padding-left:1.5rem">
                                        ${s.questions.map(q => `<li style="margin-bottom:4px">${q}</li>`).join('')}
                                    </ul>
                                </div>
                                
                                <!-- Structured Framework -->
                                <div style="background:rgba(99, 102, 241, 0.05); padding:1rem; border-radius:0.5rem; border-left:4px solid var(--primary); margin-bottom:1rem">
                                    <p style="font-size:0.8rem; color:var(--primary); font-weight:bold; margin-bottom:0.5rem">ğŸ› ï¸ Speaking Framework (Quy táº¯c Phase 1):</p>
                                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; font-size:0.85rem">
                                        <div style="color:var(--text-muted)">1. Trá»±c diá»‡n: <span style="color:var(--text-main)">I think that...</span></div>
                                        <div style="color:var(--text-muted)">2. LÃ½ do: <span style="color:var(--text-main)">One reason is...</span></div>
                                        <div style="color:var(--text-muted)">3. VÃ­ dá»¥: <span style="color:var(--text-main)">For example...</span></div>
                                        <div style="color:var(--text-muted)">4. Káº¿t quáº£: <span style="color:var(--text-main)">Therefore...</span></div>
                                    </div>
                                </div>

                                <div style="border-left:2px solid #10b981; padding-left:1rem">
                                    <p style="font-size:0.8rem; color:var(--text-muted); margin-bottom:0.5rem">Ná»™i dung gá»£i Ã½ (Sample Phrases):</p>
                                    <div style="font-size:0.85rem; line-height:1.6; color:var(--text-main)">
                                        ${s.samples || 'HÃ£y tá»± tin trÃ¬nh bÃ y theo cÃ¡ch cá»§a báº¡n!'}
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="recorder-zone">
                        <p>ğŸ™ï¸ Thu Ã¢m bÃ i nÃ³i (Ã‰P THEO KHUNG TRÃŠN)</p>
                        <div class="recorder-btns">
                            <button class="record-btn" onclick="toggleRecording('speaking')">â—</button>
                            <button class="play-btn hidden" id="listen-playback" onclick="playRecording()">â–¶ Nghe & Tá»± cháº¥m Ä‘iá»ƒm</button>
                        </div>
                        <div id="listen-status" style="margin-top:10px; font-size:0.8rem">Sáºµn sÃ ng thu Ã¢m...</div>
                    </div>
                `;
            }

            if (c.type === 'vocabulary') {
                if (currentSession) {
                    return `<div id="session-flashcard-container" class="session-container"></div>`;
                }

                const savedSentences = detail.savedSentences || [];
                return `
                    <div class="vocab-lab">
                        <div style="display:flex; justify-content:center; margin-bottom:1.5rem">
                            <button class="btn btn-primary" style="padding: 0.8rem 2rem; display:flex; align-items:center; gap:10px" onclick="startFlashcardSession('${dayId}', ${idx}, 'words')">
                                <span style="font-size:1.2rem">ğŸ´</span> Báº¯t Ä‘áº§u Há»c Flashcard (Tá»«ng tá»«)
                            </button>
                        </div>

                        <!-- Section 1: Explore -->
                        <div class="lesson-card" style="margin-bottom:1.5rem; background:rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.05)">
                            <h4 style="color:var(--text-muted); margin-bottom:1rem; font-size:0.9rem">1. Vocab Explore (15' Core + 15' MIS)</h4>
                            <p style="font-size:0.75rem; color:var(--text-muted); margin-bottom:10px">Má»—i tá»« bao gá»“m: PhÃ¡t Ã¢m + CÃ¢u Ä‘Æ¡n giáº£n (ğŸŒ±) + CÃ¢u há»c thuáº­t (ğŸ“)</p>
                            
                            <div style="display:grid; grid-template-columns: 1fr; gap:12px; margin-bottom:2rem">
                                <div style="color:var(--accent); font-weight:bold; font-size:0.8rem; border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:5px">OXFORD/CAMBRIDGE CORE</div>
                                ${(c.core || []).map(i => `
                                    <div class="vocab-item" style="background:rgba(255,255,255,0.03); padding:16px; border-radius:12px; display:flex; flex-direction:column; gap:8px; border:1px solid rgba(255,255,255,0.05); position:relative; overflow:hidden; transition: all 0.3s ease">
                                        <div style="display:flex; justify-content:space-between; align-items:center">
                                            <div>
                                                <strong style="color:var(--text-main); font-size:1.1rem">${i.w}</strong> 
                                                <span class="ipa-text" style="font-size:0.85rem; color:var(--accent); display:inline; margin-left:8px">${i.p}</span>
                                            </div>
                                            <div style="display:flex; gap:8px">
                                                <button class="mini-btn" onclick="speakPhrase('${i.w}')" title="Nghe phÃ¡t Ã¢m">ğŸ”Š</button>
                                                <a href="https://dictionary.cambridge.org/vi/dictionary/english/${i.w.toLowerCase()}" target="_blank" class="cambridge-badge" style="text-decoration:none" title="Xem táº¡i Cambridge Dictionary">
                                                    <span style="background:#112e51; color:white; font-size:0.6rem; padding:2px 6px; border-radius:4px; font-weight:800">CAMBRIDGE</span>
                                                </a>
                                            </div>
                                        </div>
                                        <div style="font-size:0.92rem; color:var(--accent); font-weight:700; margin-bottom:4px; font-style: italic; line-height:1.3">
                                            ${i.m || 'Meaning via dictionary link...'}
                                        </div>
                                        <div style="font-size:0.88rem; color:var(--text-muted); line-height:1.4; border-left:3px solid #10b981; padding-left:10px; background: rgba(16, 185, 129, 0.05); padding-top: 5px; padding-bottom: 5px;">
                                            <span style="font-size:0.7rem; color:#10b981; font-weight:800; display:block; margin-bottom:2px">PRACTICAL EXAMPLE (DAILY)</span>
                                            ${i.s || '...'}
                                        </div>
                                        <div style="font-size:0.88rem; color:var(--primary); font-style:italic; line-height:1.4; border-left:3px solid var(--primary); padding-left:10px; background: rgba(197, 160, 0, 0.05); padding-top: 5px; padding-bottom: 5px;">
                                            <span style="font-size:0.7rem; color:var(--primary); font-weight:800; display:block; margin-bottom:2px">ACADEMIC CONTEXT (MIS/BA)</span>
                                            ${i.a || '...'}
                                        </div>
                                    </div>
                                `).join('')}
 
                                <div style="color:var(--accent); font-weight:bold; font-size:0.8rem; border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:5px; margin-top:15px">MIS / BABOK SPECIALIZED</div>
                                ${(c.specialized || []).map(i => `
                                    <div class="vocab-item" style="background:rgba(255,255,255,0.03); padding:16px; border-radius:12px; display:flex; flex-direction:column; gap:8px; border:1px solid rgba(255,255,255,0.05); position:relative; transition: all 0.3s ease">
                                        <div style="display:flex; justify-content:space-between; align-items:center">
                                            <div>
                                                <strong style="color:var(--text-main); font-size:1.1rem">${i.w}</strong> 
                                                <span class="ipa-text" style="font-size:0.85rem; color:var(--accent); display:inline; margin-left:8px">${i.p}</span>
                                            </div>
                                            <div style="display:flex; gap:8px">
                                                <button class="mini-btn" onclick="speakPhrase('${i.w}')" title="Nghe phÃ¡t Ã¢m">ğŸ”Š</button>
                                                <a href="https://dictionary.cambridge.org/vi/dictionary/english/${i.w.toLowerCase()}" target="_blank" class="cambridge-badge" style="text-decoration:none" title="Xem táº¡i Cambridge Dictionary">
                                                    <span style="background:#112e51; color:white; font-size:0.6rem; padding:2px 6px; border-radius:4px; font-weight:800">CAMBRIDGE</span>
                                                </a>
                                            </div>
                                        </div>
                                        <div style="font-size:0.92rem; color:var(--accent); font-weight:700; margin-bottom:4px; font-style: italic; line-height:1.3">
                                            ${i.m || 'Meaning via dictionary link...'}
                                        </div>
                                        <div style="font-size:0.88rem; color:var(--text-muted); line-height:1.4; border-left:3px solid #10b981; padding-left:10px; background: rgba(16, 185, 129, 0.05); padding-top: 5px; padding-bottom: 5px;">
                                            <span style="font-size:0.7rem; color:#10b981; font-weight:800; display:block; margin-bottom:2px">PRACTICAL EXAMPLE (DAILY)</span>
                                            ${i.s || '...'}
                                        </div>
                                        <div style="font-size:0.88rem; color:var(--primary); font-style:italic; line-height:1.4; border-left:3px solid var(--primary); padding-left:10px; background: rgba(197, 160, 0, 0.05); padding-top: 5px; padding-bottom: 5px;">
                                            <span style="font-size:0.7rem; color:var(--primary); font-weight:800; display:block; margin-bottom:2px">ACADEMIC CONTEXT (MIS/BA)</span>
                                            ${i.a || '...'}
                                        </div>
                                    </div>
                                `).join('')}

                                ${(c.fromListening && c.fromListening.length > 0) ? `
                                <div style="color:var(--accent); font-weight:bold; font-size:0.8rem; border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:5px; margin-top:15px">ğŸ§ FROM LISTENING ACTIVITY</div>
                                ${c.fromListening.map(i => `
                                    <div class="vocab-item" onclick="speakPhrase('${i.w}')" style="background:rgba(16, 185, 129, 0.05); padding:12px; border-radius:8px; display:flex; flex-direction:column; gap:5px; cursor:pointer; border:1px solid rgba(16, 185, 129, 0.2)">
                                        <div style="display:flex; justify-content:space-between; align-items:center">
                                            <strong style="color:var(--text-main); font-size:1rem">${i.w}</strong> 
                                            <span class="ipa-text" style="font-size:0.8rem; color:#10b981">${i.p}</span>
                                        </div>
                                        <div style="font-size:0.85rem; color:var(--text-muted)">ğŸ“ ${i.context || '...'}</div>
                                    </div>
                                `).join('')}
                                ` : ''}
                            </div>
                        </div>

                        <!-- Section 2: Spelling Practice -->
                        <div class="lesson-card" style="margin-bottom:1.5rem">
                            <h4 style="color:var(--accent); margin-bottom:0.5rem">2. Spelling Challenge</h4>
                            <p style="font-size:0.8rem; color:var(--text-muted); margin-bottom:1rem">NhÃ¬n phiÃªn Ã¢m, Ä‘oÃ¡n vÃ  Ä‘iá»n tá»« vá»±ng Ä‘Ãºng:</p>
                            <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap:10px">
                                ${[...(c.core || []), ...(c.specialized || [])].slice(0, 6).map((item, i) => `
                                    <div style="background:rgba(255,255,255,0.03); padding:8px; border-radius:6px; display:flex; align-items:center; gap:8px">
                                        <span class="ipa-text" style="font-size:0.8rem; min-width:80px">${item.p}</span>
                                        <input type="text" placeholder="..." style="width:100%; background:transparent; border:none; border-bottom:1px solid var(--glass-border); color:var(--text-main); font-size:0.85rem; outline:none">
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <!-- Section 3: Sentence Mastery -->
                        <div class="lesson-card" style="margin-bottom:1.5rem">
                            <h4 style="color:var(--accent); margin-bottom:0.5rem">3. Sentence Mastery (Ã‰p thá»±c hÃ nh Context)</h4>
                            <p style="font-size:0.8rem; color:var(--text-muted); margin-bottom:1rem">Má»—i tá»« vá»±ng pháº£i Ä‘áº·t Ä‘á»§ 2 cÃ¢u theo yÃªu cáº§u Reset ná»n táº£ng:</p>
                            
                            <div style="margin-bottom:1rem; display:flex; flex-wrap:wrap; gap:8px">
                                ${[...(c.core || []), ...(c.specialized || [])].map(item => `
                                    <span class="word-pill" onclick="insertWord('${item.w}')">${item.w}</span>
                                `).join('')}
                            </div>
                            
                            <div class="toolbar">
                                <button class="tool-btn" onclick="formatDoc('bold')"><b>B</b></button>
                                <button class="tool-btn" onclick="formatDoc('foreColor', '#10b981')">Green</button>
                                <button class="tool-btn" style="background:var(--primary); color:white; border:none" onclick="checkSentenceGrammar('${dayId}', ${idx})">ğŸ” Kiá»ƒm tra ngá»¯ phÃ¡p (AI Check)</button>
                            </div>

                            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px">
                                <div>
                                    <div style="font-size:0.75rem; color:#10b981; margin-bottom:5px">ğŸŒ± CÃ¢u Ä‘Æ¡n giáº£n (Daily Context):</div>
                                    <div class="sentence-editor" id="vocab-editor-simple" contenteditable="true" placeholder="VÃ­ dá»¥: I have a plan." style="min-height:80px; font-size:0.85rem"></div>
                                </div>
                                <div>
                                    <div style="font-size:0.75rem; color:var(--accent); margin-bottom:5px">ğŸ“ CÃ¢u há»c thuáº­t (Academic/Work Context):</div>
                                    <div class="sentence-editor" id="vocab-editor" contenteditable="true" placeholder="VÃ­ dá»¥: The strategic plan outlines our goals." style="min-height:80px; font-size:0.85rem">${detail.editorContent || ''}</div>
                                </div>
                            </div>
                            
                            <!-- Grammar Feedback Box -->
                            <div id="grammar-box" class="grammar-feedback">
                                <span class="feedback-title" id="grammar-title">Káº¿t quáº£ phÃ¢n tÃ­ch tá»« AI</span>
                                <div class="feedback-reason" id="grammar-reason"></div>
                            </div>
                        </div>

                        <!-- Section 4: Sentence Collection -->
                        <div class="lesson-card" style="margin-bottom:1.5rem; border: 1px solid rgba(16, 185, 129, 0.3)">
                            <h4 style="color:#10b981; margin-bottom:0.5rem">4. My Sentence Bank (Chuáº©n IELTS)</h4>
                            <p style="font-size:0.8rem; color:var(--text-muted); margin-bottom:1rem">Nhá»¯ng cÃ¢u báº¡n Ä‘Ã£ viáº¿t Ä‘Ãºng vÃ  lÆ°u trá»¯:</p>
                            <div id="sentence-bank" style="font-size:0.9rem; line-height:1.6">
                                ${savedSentences.length > 0 ? savedSentences.map((s, i) => `
                                    <div style="margin-bottom:8px; padding:8px; background:rgba(255,255,255,0.02); border-radius:4px; border-left:3px solid #10b981; display:flex; justify-content:space-between; align-items:center;">
                                        <span>âœ¨ ${s}</span>
                                        <button onclick="removeFromSentenceBank('${dayId}', ${idx}, ${i})" style="background:none; border:none; color:#ef4444; cursor:pointer; padding:4px 8px; font-size:1rem; line-height:1">Ã—</button>
                                    </div>
                                `).join('') : '<span style="color:var(--text-muted)">ChÆ°a cÃ³ cÃ¢u nÃ o Ä‘Æ°á»£c lÆ°u. HÃ£y kiá»ƒm tra & lÆ°u cÃ¢u á»Ÿ má»¥c 3!</span>'}
                            </div>
                        </div>

                        <!-- Recording Section -->
                        <div class="recorder-zone">
                            <p>ğŸ™ï¸ Thu Ã¢m Ä‘á»c danh sÃ¡ch tá»« & cÃ¡c cÃ¢u Ä‘Ã£ Ä‘áº·t</p>
                            <div class="recorder-btns">
                                <button class="record-btn" onclick="toggleRecording('vocabulary')">â—</button>
                                <button class="play-btn hidden" id="listen-playback" onclick="playRecording()">â–¶ Nghe láº¡i bÃ i há»c</button>
                            </div>
                            <div id="listen-status" style="margin-top:10px; font-size:0.8rem">Sáºµn sÃ ng thu Ã¢m...</div>
                        </div>
                    </div>
                `;
            }

            if (c.type === 'grammar') {
                return `
                    <div class="lesson-card" style="border-left: 4px solid #f59e0b">
                        <!-- Theory Block -->
                        <div style="background:rgba(245,158,11,0.08); border-radius:10px; padding:16px; margin-bottom:1.5rem">
                            <div style="font-size:0.75rem; text-transform:uppercase; color:#f59e0b; font-weight:800; margin-bottom:8px">ğŸ“š LÃ½ thuyáº¿t</div>
                            <div style="font-size:0.9rem; color:var(--text-main); line-height:1.6">${c.theory || ''}</div>
                        </div>

                        <!-- Formula Block -->
                        <div style="background:rgba(99,102,241,0.1); border-radius:10px; padding:14px; margin-bottom:1.5rem; text-align:center">
                            <div style="font-size:0.75rem; text-transform:uppercase; color:var(--accent); font-weight:800; margin-bottom:6px">ğŸ“Œ CÃ´ng thá»©c</div>
                            <div style="font-size:1.2rem; font-weight:800; color:var(--text-main); font-family:monospace; letter-spacing:1px">${c.formula || ''}</div>
                        </div>

                        <!-- Examples Block -->
                        <div style="margin-bottom:1.5rem">
                            <div style="font-size:0.75rem; text-transform:uppercase; color:var(--accent); font-weight:800; margin-bottom:10px">ğŸ’¡ VÃ­ dá»¥ thá»±c táº¿ (Dual-Context)</div>
                            <div style="display:grid; gap:10px">
                            ${(c.examples || []).map(ex => `
                                <div style="background:rgba(255,255,255,0.03); border-radius:8px; padding:14px; border-left:4px solid ${ex.context.includes('MIS') || ex.context.includes('Academic') ? '#6366f1' : '#10b981'}">
                                    <div style="font-size:0.75rem; color:${ex.context.includes('MIS') || ex.context.includes('Academic') ? '#6366f1' : '#10b981'}; font-weight:700; margin-bottom:6px">${ex.context}</div>
                                    <div style="font-size:0.95rem; color:var(--text-main); margin-bottom:4px" onclick="speakPhrase('${ex.sentence.replace(/\*\*/g, '').replace(/'/g, "\\'")}')">â–¶ ${ex.sentence.replace(/\*\*(.+?)\*\*/g, '<strong style="color:#f59e0b">$1</strong>')}</div>
                                    <div style="font-size:0.78rem; color:var(--text-muted); font-style:italic">ğŸ’¡ ${ex.note || ''}</div>
                                </div>
                            `).join('')}
                            </div>
                        </div>

                        <!-- Exercise Block -->
                        <div style="background:rgba(16,185,129,0.05); border-radius:10px; padding:14px; margin-bottom:1.5rem; border:1px dashed rgba(16,185,129,0.3)">
                            <div style="font-size:0.75rem; text-transform:uppercase; color:#10b981; font-weight:800; margin-bottom:8px">âœï¸ Thá»±c hÃ nh viáº¿t</div>
                            <div style="font-size:0.85rem; color:var(--text-muted); margin-bottom:10px">${c.exercise || 'Viáº¿t 2-3 cÃ¢u sá»­ dá»¥ng cáº¥u trÃºc ngá»¯ phÃ¡p hÃ´m nay.'}</div>
                            <div contenteditable="true" style="min-height:70px; background:rgba(255,255,255,0.03); border-radius:6px; padding:10px; border:1px solid rgba(255,255,255,0.1); font-size:0.9rem; color:var(--text-main); outline:none" placeholder="Viáº¿t cÃ¢u vÃ o Ä‘Ã¢y..."></div>
                        </div>

                        <!-- Speaking Practice -->
                        <div class="recorder-zone">
                            <p>ğŸ™ï¸ NÃ³i to cÃ¢u vÃ­a dá»¥ vÃ o mic Ä‘á»ƒ luyá»‡n pháº£n xáº¡</p>
                            <div class="recorder-btns">
                                <button class="record-btn" onclick="toggleRecording('speaking')">â—</button>
                                <button class="play-btn hidden" id="listen-playback" onclick="playRecording()">â–¶ Nghe láº¡i</button>
                            </div>
                            <div id="listen-status" style="margin-top:10px; font-size:0.8rem">Sáºµn sÃ ng...</div>
                        </div>
                    </div>
                `;
            }

            return renderSteps(c.steps);
        }

        function renderSteps(steps) {
            if (!steps || steps.length === 0) return '';
            return `
                <div class="lesson-card">
                    ${steps.map(s => `
                        <div class="lesson-step">
                            <div class="step-num">${s.num}</div>
                            <div class="step-content">
                                ${s.text}
                                ${s.link ? `<br><a href="${s.link}" target="_blank" class="resource-link">TÃ i liá»‡u â†’</a>` : ''}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // Feature Actions
        let mediaRecorder;
        let audioChunks = [];
        let audioUrl = null;

        window.toggleRecording = async (type) => {
            let btn, statusLabel, playbackBtn;

            if (type === 'flashcard') {
                btn = document.getElementById('fc-record-btn');
                statusLabel = document.getElementById('fc-status');
                playbackBtn = document.getElementById('fc-playback-btn');
            } else if (type === 'pronunciation') {
                btn = document.getElementById('pron-rec');
                statusLabel = document.getElementById('listen-status');
                playbackBtn = document.getElementById('pron-playback');
            } else {
                // Default fallback for legacy sections
                btn = document.getElementById('listen-rec') || document.querySelector('.record-btn');
                statusLabel = document.getElementById('listen-status');
                playbackBtn = document.getElementById('listen-playback');
            }

            if (!btn) {
                console.warn("Recording button not found for type:", type);
                return;
            }

            // Visual flash feedback
            btn.style.transform = 'scale(1.2)';
            setTimeout(() => btn.style.transform = '', 100);

            if (!btn.classList.contains('recording')) {
                // START RECORDING
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    mediaRecorder = new MediaRecorder(stream);
                    audioChunks = [];

                    mediaRecorder.ondataavailable = (event) => {
                        audioChunks.push(event.data);
                    };

                    mediaRecorder.onstop = () => {
                        const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                        audioUrl = URL.createObjectURL(audioBlob);
                        if (playbackBtn) {
                            playbackBtn.classList.remove('hidden');
                        }
                        if (statusLabel) statusLabel.innerText = "ÄÃ£ lÆ°u báº£n ghi Ã¢m! Nháº¥n Play Ä‘á»ƒ nghe láº¡i.";
                    };

                    mediaRecorder.start();
                    btn.classList.add('recording');
                    btn.innerHTML = "â–  Dá»«ng";
                    if (statusLabel) statusLabel.innerText = "Äang ghi Ã¢m...";
                    if (playbackBtn) playbackBtn.classList.add('hidden');
                } catch (err) {
                    console.error("Recording error:", err);
                    alert("KhÃ´ng thá»ƒ truy cáº­p Microphone. HÃ£y cháº¯c cháº¯n báº¡n Ä‘Ã£ cáº¥p quyá»n ghi Ã¢m cho trang web nÃ y.");
                }
            } else {
                // STOP RECORDING
                if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                    mediaRecorder.stop();
                }
                btn.classList.remove('recording');

                // Set text based on type
                if (type === 'pronunciation') {
                    btn.innerHTML = "<span>â—</span> Báº¯t Ä‘áº§u Shadowing";
                } else if (type === 'flashcard' || type === 'listening') {
                    btn.innerHTML = "â—";
                } else {
                    btn.innerHTML = 'ğŸ¤ Báº¯t Ä‘áº§u ghi Ã¢m';
                }

                if (type === 'listening') {
                    const acc = document.getElementById('listen-acc');
                    if (acc) acc.classList.remove('hidden');
                }
            }
        };

        window.playRecording = () => {
            if (audioUrl) {
                const audio = new Audio(audioUrl);
                audio.play();
            }
        };

        window.speakPhrase = (text, isSlow = false) => {
            if ('speechSynthesis' in window) {
                // Cancel any ongoing speech
                window.speechSynthesis.cancel();

                let processedText = text;
                if (isSlow) {
                    // Add pauses between words for "robot" effect
                    processedText = text.split(' ').join(', ');
                }

                const utterance = new SpeechSynthesisUtterance(processedText);
                utterance.lang = 'en-US';
                utterance.rate = isSlow ? 0.5 : 0.8; // Very slow for robot, natural-ish for native
                utterance.pitch = isSlow ? 0.8 : 1.0;
                window.speechSynthesis.speak(utterance);
            }
        };

        window.insertWord = (w) => {
            const editor = document.getElementById(window.lastActiveEditorId) || document.getElementById('vocab-editor');
            if (editor) {
                editor.focus();
                document.execCommand('insertText', false, w + ' ');
            }
        };

        window.checkSentenceGrammar = async (dayId, idx) => {
            const edSimple = document.getElementById('vocab-editor-simple');
            const edAcademic = document.getElementById('vocab-editor');
            const box = document.getElementById('grammar-box');
            const title = document.getElementById('grammar-title');
            const reason = document.getElementById('grammar-reason');

            const simpleText = edSimple ? edSimple.innerText.trim() : "";
            const academicText = edAcademic ? edAcademic.innerText.trim() : "";

            if (!simpleText && !academicText) {
                alert("Vui lÃ²ng nháº­p Ã­t nháº¥t má»™t cÃ¢u Ä‘á»ƒ kiá»ƒm tra!");
                return;
            }

            // Show checking status
            box.style.display = 'block';
            box.classList.remove('error');
            box.style.background = 'rgba(99, 102, 241, 0.1)';
            title.innerHTML = "ğŸ“¡ Äang káº¿t ná»‘i AI (LanguageTool)...";
            reason.innerHTML = "Äang phÃ¢n tÃ­ch cáº¥u trÃºc 2 lá»›p (Daily & Academic)...";

            const checkText = async (text, label) => {
                if (!text) return { matches: [], custom: [] };
                const response = await fetch('https://api.languagetool.org/v2/check', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: new URLSearchParams({ 'text': text, 'language': 'en-US' })
                });
                const data = await response.json();

                let custom = [];
                const words = text.split(/\s+/).filter(w => w.length > 0);
                if (words.length < 4) {
                    custom.push({ message: "CÃ¢u quÃ¡ ngáº¯n.", category: "Brevity", errorText: text });
                }
                if (!/[.!?"]\s*$/.test(text)) {
                    custom.push({ message: "Thiáº¿u dáº¥u káº¿t thÃºc.", category: "Punctuation", errorText: "Cuá»‘i cÃ¢u" });
                }

                return { matches: data.matches, custom, label };
            };

            try {
                const results = [];
                if (simpleText) results.push(await checkText(simpleText, "ğŸŒ± CÃ¢u Ä‘Æ¡n giáº£n"));
                if (academicText) results.push(await checkText(academicText, "ğŸ“ CÃ¢u há»c thuáº­t"));

                const allErrors = results.filter(r => r.matches.length > 0 || r.custom.length > 0);

                if (allErrors.length > 0) {
                    box.classList.add('error');
                    title.innerHTML = `âŒ PhÃ¡t hiá»‡n lá»—i cáº§n xá»­ lÃ½:`;
                    let html = '';
                    allErrors.forEach(res => {
                        html += `<div style="margin-bottom:15px; border-bottom:1px solid rgba(239, 68, 68, 0.2); padding-bottom:10px">
                                    <strong style="color:var(--text-main)">${res.label}:</strong><ul style="padding-left:1.2rem; margin-top:5px; font-size:0.85rem">`;
                        res.custom.forEach(ce => html += `<li><span style="color:#ef4444">${ce.message}</span></li>`);
                        res.matches.forEach(m => html += `<li><span style="color:#ef4444">${m.message}</span></li>`);
                        html += `</ul></div>`;
                    });
                    reason.innerHTML = html;
                    if (edSimple && simpleText) edSimple.style.border = results.find(r => r.label === "ğŸŒ± CÃ¢u Ä‘Æ¡n giáº£n").matches.length > 0 ? "1px solid #ef4444" : "1px solid #10b981";
                    if (edAcademic && academicText) edAcademic.style.border = results.find(r => r.label === "ğŸ“ CÃ¢u há»c thuáº­t").matches.length > 0 ? "1px solid #ef4444" : "1px solid #10b981";
                } else {
                    box.classList.remove('error');
                    box.style.background = 'rgba(16, 185, 129, 0.1)';
                    title.innerHTML = "âœ… HoÃ n thÃ nh Reset Ná»n Táº£ng!";
                    reason.innerHTML = `
                        <p style="color:#10b981; font-weight:bold">Cáº£ 2 cÃ¢u Ä‘á»u chuáº©n chá»‰nh!</p>
                        <p style="font-size:0.8rem; margin-bottom:1rem">Dá»¯ liá»‡u Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ lÆ°u vÃ o Bank cÃ¡ nhÃ¢n.</p>
                        <button class="btn btn-primary" style="padding: 6px 12px; font-size: 0.8rem;" onclick="addToSentenceBank('${dayId}', ${idx})">ğŸ’¾ LÆ°u bá»™ Ä‘Ã´i context nÃ y</button>
                    `;
                    if (edSimple) edSimple.style.border = "1px solid #10b981";
                    if (edAcademic) edAcademic.style.border = "1px solid #10b981";
                }
            } catch (err) {
                console.error(err);
                title.innerHTML = "âš ï¸ Lá»—i káº¿t ná»‘i AI";
            }
        };

        window.addToSentenceBank = (dayId, idx) => {
            const edSimple = document.getElementById('vocab-editor-simple');
            const edAcademic = document.getElementById('vocab-editor');
            const simpleText = edSimple ? edSimple.innerText.trim() : "";
            const academicText = edAcademic ? edAcademic.innerText.trim() : "";

            if (!academicText) return;

            const combinedText = simpleText ? `[ğŸŒ± ${simpleText}] [ğŸ“ ${academicText}]` : academicText;

            if (!userData[dayId].details[idx].savedSentences) {
                userData[dayId].details[idx].savedSentences = [];
            }

            if (userData[dayId].details[idx].savedSentences.includes(combinedText)) {
                alert("Bá»™ context nÃ y Ä‘Ã£ tá»“n táº¡i trong Bank!");
                return;
            }

            userData[dayId].details[idx].savedSentences.push(combinedText);
            save();

            // Update UI
            const bank = document.getElementById('sentence-bank');
            const sentences = userData[dayId].details[idx].savedSentences;
            bank.innerHTML = sentences.map((s, i) => `
                <div style="margin-bottom:8px; padding:8px; background:rgba(255,255,255,0.02); border-radius:4px; border-left:3px solid #10b981; display:flex; justify-content:space-between; align-items:center;">
                    <span style="font-size:0.85rem">${s}</span>
                    <button onclick="removeFromSentenceBank('${dayId}', ${idx}, ${i})" style="background:none; border:none; color:#ef4444; cursor:pointer; padding:4px 8px; font-size:1rem; line-height:1">Ã—</button>
                </div>
            `).join('');

            // Success Feedback
            const reason = document.getElementById('grammar-reason');
            reason.innerHTML = `<p style="color:#10b981; font-weight:bold">âœ… ÄÃ£ lÆ°u bá»™ Context thÃ nh cÃ´ng!</p>`;

            // Clear editors
            setTimeout(() => {
                if (edSimple) edSimple.innerHTML = '';
                if (edAcademic) edAcademic.innerHTML = '';
                document.getElementById('grammar-box').style.display = 'none';
                if (edSimple) edSimple.style.border = "1px solid var(--glass-border)";
                if (edAcademic) edAcademic.style.border = "1px solid var(--glass-border)";
            }, 1000);
        };

        window.removeFromSentenceBank = (dayId, idx, sIdx) => {
            if (!confirm("Báº¡n cÃ³ cháº¯c muá»‘n xÃ³a cÃ¢u nÃ y khá»i Sentence Bank?")) return;

            userData[dayId].details[idx].savedSentences.splice(sIdx, 1);
            save();

            // Refresh UI
            const bank = document.getElementById('sentence-bank');
            const sentences = userData[dayId].details[idx].savedSentences;
            if (sentences && sentences.length > 0) {
                bank.innerHTML = sentences.map((s, i) => `
                    <div style="margin-bottom:8px; padding:8px; background:rgba(255,255,255,0.02); border-radius:4px; border-left:3px solid #10b981; display:flex; justify-content:space-between; align-items:center;">
                        <span>âœ¨ ${s}</span>
                        <button onclick="removeFromSentenceBank('${dayId}', ${idx}, ${i})" style="background:none; border:none; color:#ef4444; cursor:pointer; padding:4px 8px; font-size:1rem; line-height:1">Ã—</button>
                    </div>
                `).join('');
            } else {
                bank.innerHTML = '<span style="color:var(--text-muted)">ChÆ°a cÃ³ cÃ¢u nÃ o Ä‘Æ°á»£c lÆ°u. HÃ£y kiá»ƒm tra & lÆ°u cÃ¢u á»Ÿ má»¥c 3!</span>';
            }
        };

        window.formatDoc = (cmd, val) => {
            document.execCommand(cmd, false, val);
        };

        window.startTask = (dayId, idx) => {
            if (!userData[dayId]) userData[dayId] = { tasks: [], notes: [], details: {} };
            if (!userData[dayId].details) userData[dayId].details = {};
            if (!userData[dayId].details[idx]) userData[dayId].details[idx] = { sessions: 0 };

            userData[dayId].tasks[idx] = false;
            userData[dayId].details[idx].startTime = Date.now();

            save();
            renderTree();
            closeModal();

            const [p, stageId, w, weekId, d, dayNum] = dayId.split(/[-wdr]/).filter(Boolean).map(Number);
            const currentStage = stages.find(s => s.id === stageId);
            const blockId = `p${stageId}-w${weekId}`;
            const currentWeekInfo = weekDetails[blockId];
            const taskName = (currentWeekInfo && currentWeekInfo.days && currentWeekInfo.days[dayNum]) ? currentWeekInfo.days[dayNum][idx] : currentStage.tasks[idx];
            openTaskForm(dayId, idx, taskName);
        };

        window.finishTask = (dayId, idx) => {
            const noteVal = document.getElementById('modal-note').value.trim();
            const vocabEditor = document.getElementById('vocab-editor');
            const editorContent = vocabEditor ? vocabEditor.innerHTML : null;

            const detail = userData[dayId].details[idx];
            detail.note = noteVal;
            if (editorContent !== null) detail.editorContent = editorContent;

            detail.sessions = (detail.sessions || 0) + 1;

            const [p, stageId, w, weekId, d, dayNum] = dayId.split(/[-wdr]/).filter(Boolean).map(Number);
            const currentStage = stages.find(s => s.id === stageId);
            const blockId = `p${stageId}-w${weekId}`;
            const currentWeekInfo = weekDetails[blockId];
            const displayTasks = (currentWeekInfo && currentWeekInfo.days && currentWeekInfo.days[dayNum]) ? currentWeekInfo.days[dayNum] : currentStage.tasks;

            if (!userData[dayId].tasks || userData[dayId].tasks.length === 0) {
                userData[dayId].tasks = new Array(displayTasks.length).fill(false);
            }
            userData[dayId].tasks[idx] = true;

            if (!userData[dayId].notes) userData[dayId].notes = new Array(displayTasks.length).fill('');
            userData[dayId].notes[idx] = noteVal;

            save();
            renderTree();
            closeModal();
        };

        window.closeModal = () => {
            const modal = document.querySelector('.modal-overlay');
            if (modal) modal.remove();
            // Reset session state when closing to prevent blank screen "click in/out" issue
            currentSession = null;
        };

        function renderPills(blockId) {
            let pills = '';
            const daysInWeek = (weekDetails[blockId] && weekDetails[blockId][7]) ? 7 : 6;
            for (let d = 1; d <= daysInWeek; d++) {
                const dayId = `${blockId}-d${d}`;
                const completed = isDayDone(dayId);
                pills += `<div class="pill ${completed ? 'active' : ''}"></div>`;
            }
            return pills;
        }

        function isDayDone(dayId) {
            if (!userData[dayId] || !userData[dayId].tasks) return false;
            return userData[dayId].tasks.every(t => t === true);
        }

        function getTaskStatus(dayId, idx) {
            return (userData[dayId]?.tasks?.[idx]) ? 'done' : '';
        }

        function toggleTask(dayId, idx, taskLength) {
            if (!userData[dayId]) userData[dayId] = { tasks: new Array(taskLength).fill(false), notes: new Array(taskLength).fill('') };
            if (!userData[dayId].tasks) userData[dayId].tasks = new Array(taskLength).fill(false);

            userData[dayId].tasks[idx] = !userData[dayId].tasks[idx];
            save();
            renderTree();
        }

        function saveTaskNote(dayId, idx, value, taskLength) {
            if (!userData[dayId]) userData[dayId] = { tasks: new Array(taskLength).fill(false), notes: new Array(taskLength).fill('') };
            if (!userData[dayId].notes) userData[dayId].notes = new Array(taskLength).fill('');

            userData[dayId].notes[idx] = value;
            save();
        }

        function updateOverallProgress() {
            let totalTasks = 0;
            let completedTasks = 0;
            let totalSessionsGlobal = 0;

            // 3 Blocks * 12 Weeks * 6 Days * 4 Tasks
            totalTasks = 3 * 12 * 6 * 4;

            Object.keys(userData).forEach(dayId => {
                const dayData = userData[dayId];
                if (dayData.tasks) {
                    dayData.tasks.forEach(t => { if (t) completedTasks++; });
                }
                if (dayData.details) {
                    Object.keys(dayData.details).forEach(idx => {
                        totalSessionsGlobal += (dayData.details[idx].sessions || 0);
                    });
                }
            });

            const percent = Math.round((completedTasks / totalTasks) * 100);
            document.getElementById('overall-val').innerText = percent + '%';
            document.getElementById('total-sessions-global').innerText = totalSessionsGlobal;

            // Update current phase (mapped to 3 Blocks)
            if (percent < 33) document.getElementById('current-phase-name').innerText = "Block 1: Foundation (0-5.0)";
            else if (percent < 66) document.getElementById('current-phase-name').innerText = "Block 2: Academy (5.0-6.5)";
            else document.getElementById('current-phase-name').innerText = "Block 3: Precision (6.5-7.0+)";
        }

        // Keyboard Shortcuts for Flashcards
        document.addEventListener('keydown', (e) => {
            if (!currentSession) return;

            const isTyping = e.target.tagName === 'TEXTAREA' ||
                e.target.tagName === 'INPUT' ||
                e.target.contentEditable === 'true';
            if (isTyping) return;

            const key = e.key.toLowerCase();
            const code = e.code;

            // Navigation
            if (code === 'ArrowRight' || key === 'n') {
                nextFlashcard();
            } else if (code === 'ArrowLeft' || key === 'b') {
                prevFlashcard();
            }
            // Interaction
            else if (code === 'Space' || code === 'Enter') {
                e.preventDefault();
                flipFlashcard();
            }
            // Recording Features
            else if (code === 'KeyR' || key === 'r') {
                e.preventDefault();
                window.toggleRecording('flashcard');
            } else if (code === 'KeyP' || key === 'p') {
                e.preventDefault();
                window.playRecording();
            } else if (code === 'KeyS' || key === 's') {
                e.preventDefault();
                const item = currentSession.items[currentSession.currentIndex];
                if (item) window.speakPhrase(item.text || item.w);
            }
        });

        window.onload = () => {
            renderTree();
            updateOverallProgress();
        };
    </script>
</body>

</html>